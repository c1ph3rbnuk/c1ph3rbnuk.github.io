
[{"content":"This was an end of year jeopardy style CTF that ran from 12:00pm 31/12/2022 to 9:00pm 01/01/2023 organized by our friends from Tanzania. It was a solo run CTF challenge that each player played alone. I managed position 7 finally. The CTF challenges ranged from Steg(were preety tough), Crypto, Forensics, Web, etc..\nIn this post i will be covering step by step solutions to challenges i solved.\nCryptography # warm-up # use your mental skills to edit some part of the flag you will get after decoding the cipher: NWHF{p2Ev9fX_M9_vkrIM9Zk3iAR}\u0026rsquo;''\nThis was a ceasar c1pher. One of my best online tools for decoding and decrypting cryptographic algorithms is dcode. It\u0026rsquo;s a pool of cryptographic tool to crack most encodings and encryptions. So, bruteforcing against all possible 26 keys of the ceasar cipher gets us this flag UDOM{w2Lc9mE_T9_cryPT9Gr3pHY}.The flag stated we should edit some part of the flag to make sense. Editing the flag to read \u0026ldquo;welcome to cryptograpghy\u0026rdquo; in 1337 speak, 2 becomes 3, 9 becomes 0, and 3 becomes 4. Therefore the final flag was UDOM{w3Lc0mE_T0_cryPT0Gr4PHy}.\nBABA # Our previous tool dcode has a tool called cipher identifier(I told you it\u0026rsquo;s a collection of tools) that helps you recognize the type of encryption or encoding that was used to mangle the ciphertext. Slamming our ciphertext it and the first hit tells us that this is a Beacon cipher which is a type of substitution cipher. Again our dcode is a \u0026ldquo;one size fits all\u0026rdquo; tool. Using Beacon cipher against our blob we get FLAGWHEREAREMYEGGS. Following our flag formats UDOM{XXX} we can easily recognize that the flag is UDOM{WHERE_ARE_MY_EGGS}.\nvigecrack # In this challenge we just had the following ciphertext ZDQQ{i3f3_k3_q0_a1gGr3ffg!!!}.\nFrom the challenge name we can assume that this is a vigenere cipher. Vigenere cipher is a type of substitution cipher but it uses different cipher alphabets for encryption. Using this decode Vigenere decoder and knowing part of our flag is UDOM we can use known plaintext attack against it.\nWe get the flag UDOM{d3f3_i3_m0_v1gEn3afe!!!}. It wasn\u0026rsquo;t the flag though because it doesn\u0026rsquo;t make sensse yet. I had to get a hint for 200 points \u0026#x1f62d; The hint said social media is the key. I remembered seeing the word FACE besides my flag. Well, dcode is very generous to even include the key that was used used for decryption. I finally figured that the full key was FACEBOOK. This time i used the \u0026ldquo;Knowing the key decryption method\u0026rdquo; and WALLAH!! there was our final flag UDOM{h3r3_w3_g0_v1gEn3ers!!!} \u0026#x263a;\u0026#xfe0f;\nThis challenge reminded me of the quote that says \u0026ldquo;It\u0026rsquo;s a skill of great men to make sense out of nonsense\u0026rdquo; \u0026#x1f603;\nOSINT # Time to get detective with OSINT challenges.\nplace # This was easy peasy. Doing google reverse image search you\u0026rsquo;ll find this link Kalambo falls from tripadvisor that tells you that the falls is in Rukwa region. Following the flag formart the flag becomes UDOM{Rukwa}\nForensics # file # Attached was a file names flag.zip. Running file flag,zip identified the file as Zip file. I unzipped the file use unzip file.pdf and then determined the file type again with file flag.pdf. It is always a good start to identify a file with it\u0026rsquo;s magic byte first. DON\u0026rsquo;T TRUST EXTENSIONS. A magic byte is usually a specific number usually in hexadecimal that is used to identify file type even if the extension is changed. And bang!!! \u0026ldquo;the pdf was not a pdf\u0026rdquo;, it\u0026rsquo;s actually a WAVE audio file. Wave audio file usualy take the .wav extension. Saved it with the right extension and opened it with an audio player software and what do i hear; i hear the famous beeps that identifies it as Morse code. I have this online favourite tool for decoding morsecode Morse code decoder. The text decodes to M 0 R S 3 S 0 U N D 5 B 3 T T 3 R 1 N M I L 1 T A R 1 3 S. Wrapping it in our flag format becomes UDOM{M0RS3S0UND5B3TT3R1NMIL1TAR13S}\nfile2 # A zip file was provided containing a folder name UDOM_people_folder. The folder had a totaling 9081 files(subfolders and files). All the files were in txt. We had to find the flag. A needle in a haystack right?\u0026#x1f628; Yeah, forensics causes headache \u0026#x1f605;. Unix has a tool called grep with helps you print all matches to a pattern. We know the flag starts with UDOM{. Let\u0026rsquo;s grep that and hope to find a match. We found a match but it\u0026rsquo;s not the real flag, it\u0026rsquo;s a bait \u0026#x1f612;. How did they even know i\u0026rsquo;ll fall for that? Well, time to get creative. the decription says \u0026ldquo;Forensics causes headaches\u0026rdquo; . To me it means \u0026ldquo;It\u0026rsquo;s hard\u0026rdquo;. How about we try to find a match on the word \u0026ldquo;hard\u0026rdquo;. Ooh\u0026#x1f62e; There is something spicy at the end ladies and gentlemen. And that was the flag UDOM{362d414349412454414d56455459393044392f4a43575a393145424e2d41484342334938583642495745344a432e3946205543584237484341343844474443584738}\nSteganography # Simple stego # This was very simple. If you zoom closely you\u0026rsquo;ll notice the flag on the top left conner of the image. UDOM{BR1LL14NT_5T4RT5_H3R3}\nhappy new year # With this i tried exiftool, stegsolve,..** but i didn\u0026rsquo;t find anything. Finally i tried steghide and i found that it requires a password to extract embeded files. Stegseek is one of the steganography bruteforce tools that given a wordlist will try cracking the password. .\nBingo!! We get our flag.\nData 1 # This challenge was closely related to the data 1 challenge but i could\u0026rsquo;t decode the last part of the data 1 challenge \u0026#x1f61e;\n50 4b 03 04 14 00 09 00 63 00 85 19 9f 55 00 00 00 00 00 00 00 00 3d 00 00 00 0e 00 2b 00 77 61 79 74 6f 66 6c 61 67 32 2e 74 78 74 55 54 0d 00 07 db ee af 63 db ee af 63 db ee af 63 75 78 0b 00 01 04 e8 03 00 00 04 e8 03 00 00 01 99 07 00 01 00 41 45 03 08 00 6a 74 e9 de 2c f5 76 1a 62 3c 55 06 c0 1c c2 23 ad 52 18 89 f1 97 65 60 fc 48 25 7c cd 24 bc 0a 22 27 d8 62 0e 12 58 ad aa 75 6b 6d 95 e3 e1 3d 54 ee 24 8e 78 e5 af 15 4c c5 5e 1b e9 84 cc cb c0 4e 24 d1 42 3d 23 33 c3 07 03 8d dc e7 19 83 25 2f ff e0 49 4d 58 f0 68 4d c3 50 4b 07 08 cd c5 bf 2a 5b 00 00 00 3d 00 00 00 50 4b 01 02 14 03 14 00 09 00 63 00 85 19 9f 55 cd c5 bf 2a 5b 00 00 00 3d 00 00 00 0e 00 2b 00 00 00 00 00 00 00 00 00 a4 81 00 00 00 00 77 61 79 74 6f 66 6c 61 67 32 2e 74 78 74 55 54 0d 00 07 db ee af 63 db ee af 63 db ee af 63 75 78 0b 00 01 04 e8 03 00 00 04 e8 03 00 00 01 99 07 00 01 00 41 45 03 08 00 50 4b 05 06 00 00 00 00 01 00 01 00 67 00 00 00 c2 00 00 00 00 00\nThis clearly looked like a hex dump. The magic byte 50 4b represents a zip file. You can learn more about magic bytes here File signatures. Linux has a command called xxd that can help creating or reversing hex dumps to an original file. Let\u0026rsquo;s first copy the dump to a file names hexdump.txt then wit the -r option reverse the dump. We se that the file is a password protected zip file(it skips the unziping) containing a file named waytoflag2.txt. Some of the famous tool to crack a password protected zip file is a utilitiy called zip2john part of the John the Ripper tool and fcackzip. Let\u0026rsquo;s use zip2john with the famous wordlist rockyou.txt newyearnewfriends I had already cracked the password. It wil take sometime. the contents of the waytoflag2file.txt were \u0026quot;RldMTntiMGYnaTNfbTBkX2dzM19uNDVndmlfMHVfeGlia2cwX2hnM3QwfQ==\u0026quot;. Sure! This looks like base64, let\u0026rsquo;s have some fun! It\u0026rsquo;s time to ask for help from our friend cipher identifier. A if we try the option we finally realize it was Atbash Cipher. And the flag is UDOM{y0u'r3_n0w_th3_m45ter_0f_crypt0_st3g0}\nWeb # Lemme put this up-staight before we get to this part. \u0026ldquo;I\u0026rsquo;m not well versed in this category\u0026rdquo;. I had to ask ChatGPT some help \u0026#x1f602;\nTuraco # The website had a password prompt and if you submit anything it returns the following. If we view the source code we see a javascript code.\nThe function takes a one argument and splits it based on the comma delimiter and strores it in variable tab. The function contains variable pass which is an array of ascii codes. tab2 is contains the results of splitting pass on comma. The function then loops through the elements of tab2 and converts each one back to its corresponding character using String.fromCharCode(). It appends each character to the p string. The loop is stopped after the fifth iteration using break. The function then continues to loop through tab2, but this time only adds characters to p if the index of the character in the loop is greater than 5 and less than the length of tab2 minus 1. Finally, the function adds the character at index 17 of tab2 to p and assigns the resulting string to the pass variable, which is returned by the function.\nIf you have realized, the function doesn\u0026rsquo;t make use of this part of code String\\[\u0026quot;fromCharCode\u0026quot;\\](sambo(\u0026quot;\\x38\\x35\\x2c\\x36\\x38\\x2c\\x37\\x39\\x2c\\x37\\x37\\x2c\\x31\\x32\\x33\\x2c\\x34\\x39\\x2c\\x31\\x31\\x36\\x2c\\x31\\x31\\x35\\x2c\\x39\\x35\\x2c\\x39\\x37\\x2c\\x31\\x31\\x30\\x2c\\x39\\x35\\x2c\\x34\\x38\\x2c\\x31\\x30\\x39\\x2c\\x35\\x31\\x2c\\x31\\x31\\x30\\x2c\\x31\\x32\\x35\u0026quot;)); The hex character translate to these ascii codes \u0026quot;85, 68, 79, 77, 123, 49, 116, 115, 95, 97, 110, 95, 48, 109, 51, 110, 125\u0026quot;. decoding the ASCII back to text we get the flag UDOM{1ts_an_0m3n}\nTwo-step-snake # This challenge had this in it\u0026rsquo;s source code. The unescape function is a JavaScript function that can be used to decode a string that has been encoded with the escape function. The escape function URL encodes a string (by replacing certain characters with a percent sign followed by a two-digit hexadecimal code) eg space is encoded as %20.\nThe results of the uescape function will be String.fromCharCode(104,68,117,102,106,100,107,105,49,53,54). Deccoding the ASCII code results to the following string hDufjdki156 which was the password. The flag formart was UDOM{hDufjdki156}\nwRceb # ChatGPT helped me understand the code.\nThis looks like a Node.js route handler for an HTTP POST request that is listening for a /command path. When a request is received, it extracts the command field from the request body, and then passes it to the exec function. The exec function is part of the child_process module in Node.js, and it is used to execute shell commands. It takes a command as an argument and executes it in the system shell. The exec function has a callback that is called with three arguments: error, stdout, and stderr. error is an error object that is set if there is an error executing the command. stdout and stderr are strings that contain the output of the command written to standard output and standard error, respectively. If there is an error executing the command, the route handler sends an HTTP status code of 500 (Internal Server Error) and an object with the error message as the response. If the command is executed successfully, the route handler sends an object with the stdout and stderr as the response.\nNow we know we need to send a POST request to this path /command with a JSON request body that includes a command field. I have issues with my burpsuite so we are going to use the CUrL tool to send the request. We first execute the ls -la command which outputs the contents of the current directory. We can see a flag.txt file. The cat flag.txt outputs the contents of the file. UDOM{a_simpl3_code_Review3r}\nThat\u0026rsquo;s all for the first CTF of the Year buddies!! Hope you enjoyed ! See ya Next time \u0026#x1f60a;\n","date":"2 January 2022","externalUrl":null,"permalink":"/writeups/udom/","section":"Writeups","summary":"","title":"UDOM End of year CTF","type":"writeups"},{"content":"This year i attended the SheHacks Annual InterVasity CTF, a two day event hosted at USIU-Africa. It was a fun experience except the tough CTF challenges \u0026#x1f628;. This is a write-up of the few i managed to solve. \u0026#x1f60c;\nGraph1 # The link took us to this page which says \u0026quot;Graphql running...\u0026quot;\nWith basic paths check for the graphql instance i found it runs on graphql.\nThe next step is to enumerate all available types anf fields with the introspection query query={__schema{types{name,fields{name}}}} to discover the schema information.\nWith the introspection we uncover getFlag field which likely retrieves the contents of the Flagtable.\nSending query={getFlag {id flag}} returns a base64 encoded flag value.\nDecoding\u0026hellip; Voila!\u0026#x1f62e;\nAdress # books.xls Python Oletools This was an easy challenge that required knowledge in analyzing macro-based source code. Macro based malware are scripts(js, powershell,vbs) that are embedded inside Ms office documents to abuse the macro feature.\nTo view if there exists any macro emmbeded scripts in a document we use oledump.py or olevba tools.\nThe letter M next to the stream indicates that the stream contains Macro emmbeded code. We could use oledump.py books.xls -s 8 -d to read the code but olevba books.xls does a better job.\nWe can see the macro source codes for module 1 ans 2. Module 1 is a Visual Script that checks the document properties and executes the value for the property named comments. If we examine the file properties, comments has a value that spawns the command prompt and output Oops.\nThe second script is a powershell code that executes what seems to be a base64 encoded string. let\u0026rsquo;s uncover what that is.\nIt seems to be a basic PowerShell reverse shell that listens for commands from a local server(127.0.0.1) and executes those command. The challege asked for the Ip adress and the port, SHCTF{127.0.0.1:9001}\u0026#x1f603;.\n","date":"23 September 2023","externalUrl":null,"permalink":"/writeups/shehacks/","section":"Writeups","summary":"","title":"SheHacks Intervasity CTF","type":"writeups"},{"content":" The Registry # The Windows Registry located at Windows\\System32\\config is a large database that stores configuration settings for Microsoft Windows and its applications. It contains system settings, user preferences, and more.\nOn a live system, the registry can be accessed using regedit (Registry Editor). Tools like RegRipper can be used to browse registry hives from image files.\nStructure # The Registry is organized as a tree structure with keys and subkeys. The root is called HKEY, and it contains several subkeys representing different areas of the system.\nHives ‚Äì logical groups of keys and values.\nHKLM (HKEY_LOCAL_MACHINE) ‚Üí Local machine configuration HKCU (HKEY_CURRENT_USER) ‚Üí Current user configuration HKCR (HKEY_CLASSES_ROOT) ‚Üí File associations \u0026amp; class definitions HKU (HKEY_USERS) ‚Üí All user accounts Keys ‚Äì containers that hold configuration data. Example: HKLM\\Software (installed software info).\nSubkeys ‚Äì child keys beneath a parent key.\nValues ‚Äì name‚Äìvalue pairs holding specific configuration details.\nRegistry Forensics # The Windows Registry holds artifacts valuable in digital forensics. These reveal user activity, system info, device usage, and attacker traces.\nBelow are common forensic registry keys:\nüßë‚Äçüíª User Activity # Artifact\rRegistry Key\rDescription\rMRUs (Most Recently Used)\rHKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RunMRU\rTracks programs run recently.\rTyped Paths\rHKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TypedPaths\rStores paths typed into File Explorer.\rRecent File History\rHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComDlg32\\OpenSaveMRU\rTracks recently opened/saved files via common dialogs.\rProgram Usage (UserAssist)\rNTUSER.DAT\\...\\Explorer\\UserAssist\\{GUID}\\Count\rCounts program executions by the user.\rLast Key Viewed\rNTUSER.DAT\\...\\Applets\\Regedit\\LastKey\rLast accessed key in Registry Editor.\rLNK Files\rHKCU\\...\\Explorer\\RecentDocs\rShortcuts referencing files (even deleted ones). Useful for MAC times, original paths, volumes, etc.\rJump Lists\r(AutomaticDestination / CustomDestination files)\rLists recently accessed files/programs by app. Tools: jump_list_parser, jump_list_extractor.\r‚öôÔ∏è System Information # Artifact\rRegistry Key\rDescription\rAdvanced Settings\rHKCU\\...\\Explorer\\Advanced\rFile Explorer customization settings.\rComputer Name\rSYSTEM\\ControlSet001\\Control\\ComputerName\\ComputerName\rSystem hostname.\rWindows Version Info\rHKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\rWindows version and build details.\rInstalled Applications\rHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\\rList of installed apps and executables.\rServices\rSYSTEM\\ControlSet001\\Services\\\rInstalled services and drivers.\rUAC Status\rHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\rEnableLUA=1 ‚Üí UAC enabled, =0 ‚Üí disabled.\rLast Logged-in User\rHKLM\\...\\Authentication\\LogonUI\\LastLoggedOnUser\rTracks the last user to log in.\rüíæ Devices \u0026amp; Storage # Artifact\rRegistry Key\rDescription\rAuto-Run Programs\rHKLM/HKCU\\...\\Run, RunOnce\rPrograms launched at logon.\rShellBags\rHKCU\\SOFTWARE\\Microsoft\\Windows\\Shell\\BagMRU\nHKCU\\SOFTWARE\\Microsoft\\Windows\\Shell\\Bags\rFolder view preferences. Reveals deleted folders. Tool: ShellBags Explorer.\rMounted Devices\rHKLM\\SYSTEM\\CurrentControlSet\\Enum\\USBSTOR\nHKLM\\SYSTEM\\MountedDevices\rUSB/device connection history.\rSRUM Database\rC:\\Windows\\System32\\sru\\SRUDB.dat\rTracks every executed application (even deleted ones). Tools: srum_dump, srum_extractor.\rüåê Network \u0026amp; Security # Artifact\rRegistry Key\rDescription\rFirewall Status\rHKLM\\SYSTEM\\...\\FirewallPolicy\rEnableFirewall=1 ‚Üí enabled, =0 ‚Üí disabled.\rRemote Desktop\rHKLM\\SYSTEM\\...\\Control\\Terminal Server\rContains RDP settings and status.\rShared Folders\rHKLM\\SYSTEM\\...\\LanmanServer\\Shares\rInformation about shared resources.\rNetwork Interfaces\rHKLM\\SYSTEM\\...\\Tcpip\\Parameters\\Interfaces\rNetwork adapter configurations.\rNetwork List\rHKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\NetworkList\rList of networks previously connected to.\rUser Accounts\rHKLM\\SAM\\Domains\\Account\\Users\\Names\\\rAll local user accounts (including WDAGUtilityAccount).\rTimezone\rSYSTEM\\ControlSet001\\Control\\TimeZoneInformation\rSystem timezone settings.\rPrefetch \u0026 Superfetch\rHKLM\\SYSTEM\\...\\PrefetchParameters\nHKLM\\SYSTEM\\...\\Superfetch\rPerformance data. Also useful for execution history.\rSummary # Registry forensics provides investigators with insights into user actions, system configurations, network history, device usage, and persistence mechanisms. Proper analysis can reveal attacker activity and digital evidence.\n","date":"2 January 2022","externalUrl":null,"permalink":"/posts/registry/","section":"Posts","summary":"","title":"Registry Forensics Cheatsheet","type":"posts"},{"content":" My Journey through SOC and Threat Hunting! # Hello fellow cybersecurity enthusiasts!\u0026#x1f600; Today marks the beginning of an exciting journey as i dive into the world of Security Operation Center(SOC) Analysis and Threat Hunting. Join me as I embark on a three months blue team training programme by CyberTalents and TrendMicro tailored to equip learners with the skills and knowledge to defend against the ever evolving cyber threats.\nIn this post, i aim to share my notes, discoveries and hopefully triumphs as i navigate through this landscape of blue team operations. I\u0026rsquo;m determined to learn and hone my skills. Please correct me when i\u0026rsquo;m wrong! So, buckle up and let\u0026rsquo;s learn how to find the hackers lurking in our NETWORKS!!!\nThe Battle Begins! Are You Ready?\nCertified SOC Analyst # Introduction to SOC Networking Refresher Introduction to Network Security Wireshark - The Network Packet Analyzer Tshark - Into the Commandline Realm Endpoint Security Introduction to Web Security SQL Injection Path Traversal The Anatomy of Emails Log Analysis - Introduction Windows Event Logs Incident Response ","date":"12 July 2023","externalUrl":null,"permalink":"/posts/cybertalents/","section":"Posts","summary":"","title":"Cybertalents Blue team Training","type":"posts"},{"content":" What is Cryptography? # \u0026ldquo;Cryptography is the practice and study of techniques for secure communication in the presence of adversarial behaviour - (Wikipedia)\u0026rdquo; This techniques ensure that Alice can send a message to Bob without Eve compromising the confidentiality.\nToday, cryptography is wherever there is technology. That means it\u0026rsquo;s everywhere.\nApplications # Secure Communication - The core of cryptography is to ensure two parties can communicate securely. Cryptography achieves this by securing web traffic with protocols like SSL(Secure Sockets Layer) and TLS(Transport Layer Security) to ensure that sent messages can only be read by the intended receipient. Traffic in Wireless networks is also protected using the WPA2(Wifi-Protected Access 2). Same applies to cellular traffic an bluetooth. File Encryption - crptography is used to encrypt files on disk. This ensures that even when the disk is stolen, confidentiality is not compromised. Digital Rights Management - copy protections on DVDs uses cryptographic algoriths that we\u0026rsquo;ll study later. User Authentication - Cryptographic algorithms are used to hash users passwords so that when the database is compromised the hashes cannot infer the plaitext passwords. Digital Signatures - in the physical world we use handwriten signatutes to proove identity and consent in documents. Signatures provide evidence that some message originated from you or you clearly agrreed to something. In the digital world, it\u0026rsquo;s hard to use the same handwritten signatures because once an adversary has access to one of your signed documents, they could copy and paste to other documents you need to sign. Cryptography solves this problem of ditally signing by ensuring that your signature is always a function of the content being signed. This protects using the same signatute in a diferent document. Cryptocurrencies - cryptography is the foundation of anonymous digital cash like Bitcoin and Etherium. It offers the way for transactions to be verified without a trusted third party and also prevent double spending. Terminologies # Plaintext - the message in clear text that is to be transmitted. Ciphertext - the scrambled version of the message after being encrypted. Cipher - the encryption algorithm used. Keyspace - a set of possible keys that can be used. The History of Cryptography # Cryptography dates back to the 19th centuary and \u0026lsquo;it\u0026rsquo;s developement has been paralleled by cryptanalysis - the art of code breaking\u0026rsquo; and the need for secure communication during the world wars. It has evolved from simple substitution ciphers to more mordern algorithms laid on mathematical ideas.\na.) Substitution Cipher - this is a method of encrypting messages by eplacing letters in the plaintext with a random defined letter in the substitution alphabet. One earliest example of a substitution cipher was the ceasar cipher. Devised by Julias Ceasar, this algorithm encrypts a message by replacing the plaintext letters with another letter some fixed number of positions forward/backward; that is if the message is encypted with a shift of 3 forward(shift of 23 backward) - A becomes D, B becomes E\u0026hellip;\nThe key in this algorithm in the number of shifts. For example the message ATTACK AT SUNRISE encypted with a shift of 3 forward becomes DWWDFN DW VXQULVH. Decrypting a ceasar cipher reverses the method, a forward shift is decrypted by a backward shift and vice versa. Ceasar cipher is so easy to break because of its small keyspace(26 for english alphabet). This is very easy to bruteforce. Let\u0026rsquo;s crack it with a bruteforce script.\nCIPHERTEXT = \u0026#34;DWWDFN DW VXQULVH\u0026#34; KEYSPACE = 26 def bruteforce(ciphertext): for key in range(KEYSPACE): if key == 0: continue p_text = \u0026#39;\u0026#39; for i in ciphertext: c_val = ord(i) if c_val == 32: p_text += \u0026#39; \u0026#39; continue p_val = c_val - key if p_val \u0026lt; 65: p_val += 26 p_text += chr(p_val) print(f\u0026#39;Key {key} -\u0026gt; {p_text}\u0026#39;) bruteforce(CIPHERTEXT) ROT13 is another classical example of ceasar cipher with a shift of 13.\nThe Keyspace for a random substitution cipher utilizing letters in the english alphabet is 26!(number of permutations of all 26 letters). This is nearly 288. However, substitution ciphers can still be brocken using a technique frequency analysis. Frequency analysis uses variation in the occurences of letters of the alphabet in text to crack ciphers. For example, the most common letter in the english alphabet is e, appearing more than 80%. Therefore, if the most appearing letter in the ciphertext is say W, this would be likely the substitute for e. Z has the least occurence making it a substitute to the least occuring letter.\n{\r\u0026#34;type\u0026#34;: \u0026#34;bar\u0026#34;,\r\u0026#34;data\u0026#34;: {\r\u0026#34;datasets\u0026#34;: [\r{\r\u0026#34;data\u0026#34;: [\r8.17, 1.49, 2.78, 4.25, 12.70, 2.23, 2.02, 6.09, 6.97, 0.15, 0.77, 4.03, 2.41, 6.75, 7.51, 1.93, 0.10, 5.99, 6.33, 9.06, 2.76, 0.98, 2.36, 0.15, 1.97, 0.07\r],\r\u0026#34;backgroundColor\u0026#34;: \u0026#34;#19fd07\u0026#34;,\r\u0026#34;label\u0026#34;: \u0026#34;Frequency Analysis of the English Alphabets\u0026#34;\r}\r],\r\u0026#34;labels\u0026#34;: [\r\u0026#34;A\u0026#34;, \u0026#34;B\u0026#34;, \u0026#34;C\u0026#34;, \u0026#34;D\u0026#34;, \u0026#34;E\u0026#34;, \u0026#34;F\u0026#34;, \u0026#34;G\u0026#34;, \u0026#34;H\u0026#34;, \u0026#34;I\u0026#34;, \u0026#34;J\u0026#34;, \u0026#34;K\u0026#34;, \u0026#34;L\u0026#34;, \u0026#34;M\u0026#34;, \u0026#34;N\u0026#34;, \u0026#34;O\u0026#34;, \u0026#34;P\u0026#34;, \u0026#34;Q\u0026#34;, \u0026#34;R\u0026#34;, \u0026#34;S\u0026#34;, \u0026#34;T\u0026#34;, \u0026#34;U\u0026#34;, \u0026#34;V\u0026#34;, \u0026#34;W\u0026#34;, \u0026#34;X\u0026#34;, \u0026#34;Y\u0026#34;, \u0026#34;Z\u0026#34;\r]\r},\r\u0026#34;options\u0026#34;: {}\r} Imagine that we have intercepted this scrambled message. UKBYBIPOUZBCUFEEBORUKBYBHOBBRFESPVKBWFOFERVNBCVBZPRUBOFERVNBCVBPCYYFVUFOFEIKNWFRFIKJNUPWRFIPOUNVNIPUBRNCUKBEFWWFDNCHXCYBOHOPYXPUBNCUBOYNRVNIWNCPOJIOFHOPZRVFZIXUBORJRUBZRBCHNCBBONCHRJZSFWNVRJRUBZRPCYZPUKBZPUNVPWPCYVFZIXUPUNFCPWRVNBCVBRPYYNUNFCPWWJUKBYBIPOUZBCUIPOUNVNIPUBRNCHOPYXPUBNCUBOYNRVNIWNCPOJIOFHOPZRNCRVNBCUNENVVFZIXUNCHPCYVFZIXUPUNFCPWZPUKBZPUNVR Say we know that the original message was writen in english. Let\u0026rsquo;s decipher it. The first step is to perform a frequency analysis of the letters. We could also perform frequency of pair of letters(digrams, trigrams\u0026hellip;) wih this we can identify pairs line \u0026lsquo;THE\u0026rsquo;, ARE\u0026rsquo;, \u0026lsquo;ON\u0026rsquo;, \u0026lsquo;AT\u0026rsquo;\u0026hellip;etc.\nIt\u0026rsquo;s evident that \u0026lsquo;B\u0026rsquo; is the most frequent letter in the ciphertext. Let\u0026rsquo;s assume its the substitute for \u0026lsquo;E\u0026rsquo;. \u0026lsquo;N\u0026rsquo; and \u0026lsquo;U\u0026rsquo; are the next appearing letters. They could represent substitutes for \u0026lsquo;A\u0026rsquo; and \u0026lsquo;T\u0026rsquo;. Let\u0026rsquo;s perform frequency analysis of 2 pairs and seee what\u0026rsquo;s most common.\nWe notice that \u0026lsquo;NC\u0026rsquo; is the most common. Therefore i could stand for \u0026lsquo;IN\u0026rsquo;, \u0026lsquo;OF\u0026rsquo;, \u0026lsquo;BY\u0026rsquo;, \u0026lsquo;DO, \u0026lsquo;IF\u0026rsquo;\u0026hellip;etc. Let\u0026rsquo;s look at thre most frequent trigram.\nWell, we have \u0026lsquo;UKB\u0026rsquo;. Assuming we were right with our choice of \u0026lsquo;B\u0026rsquo; as a substitute of \u0026ldquo;E\u0026rdquo;. It\u0026rsquo;s fair to also asumme that \u0026lsquo;U\u0026rsquo; is a substitute of \u0026lsquo;T\u0026rsquo; and the trigram \u0026lsquo;UKB\u0026rsquo; is a substitute of \u0026lsquo;THE\u0026rsquo;.\n","date":"15 August 2023","externalUrl":null,"permalink":"/posts/cryptography/","section":"Posts","summary":"","title":"Cryptography 101","type":"posts"},{"content":" ./about_me.sh # üíº Professional Experience # ICT Assistant Jan 2025 ‚Äì Present Kenya Revenue Authority (KRA), Mombasa - Provided ICT support and troubleshooting for end-users (hardware, software, networks). - Assisted with ICT asset management (deployment, ownership change, surrender). - Monitored service desk lines \u0026 emails, ensuring prompt resolution of incidents. - Logged and categorized incidents using **Maximo ITSM tool**. Technical Intern Oct 2024 ‚Äì Dec 2024 Airtel Kenya, Nairobi - Conducted feasibility surveys for client internet installations (fiber \u0026 microwave). - Collaborated with **Nokia** on network upgrades, downgrades, and installations. ICT Attachee May 2023 ‚Äì Jul 2023 Kenya Rural Roads Authority (KeRRA), Mombasa - Assisted in tech support \u0026 system troubleshooting. - Upgraded, installed, and configured hardware \u0026 software systems. - Installed and maintained network infrastructure. üéì Education # B.Sc. in Computer Science Nov 2024 Chuka University, Tharakanithi Security Analyst Training Aug 2024 CyberShujaa - Nairobi I got admitted to the CyberShujaa Program for the Security Analyst track for the period May through August. The training contains self-paced materials and instructor-led sessions taking us through practical cybersecurity skills and soft skills.\rGraduated as the best male security analyst in my cohortü•á .\rBlue Team Training Aug 2023 Cybertalents - Egypt Cyber Threat Hunting Oct 2022 Active Countermeasures Attended a 6hr Cyber Threat Hunting level 1 course by Chris Brenton on October 4th, 2022 and learned to proactively hunt for threats on the network and use tools like ZEEK and RITA to actively look for IOC.\rEthical Hacking Training Aug 2021 Cybertalents - Egypt ‚ö° Skills Matrix # üèÜ Achievements \u0026amp; Awards # ü•à Cyberlimpics CTF ‚Äî 1st Runners-up June 2025\nü•â BSides Nairobi CTF ‚Äî 2nd Runners-up Oct 2024\nüèÖ CyberShujaa Programme ‚Äî Best Male Security Analyst ‚Äì Cohort 7 Aug 2024\nü•â Daystar Hackathon ‚Äî 2nd Runners-up ( CTF Category) Jun 2024\nü•à Africa‚Äôs Talking Hackathon ‚Äî 1st Runners-up Mar 2024\nü•â CA Cybersecurity Hackathon ‚Äî 2nd Runners-up ( Mombasa Region) Sep 2023\nüìú Certifications # Certified Network Security Practitioner (CNSP) ‚Äì The SecOps Group Administer Active Directory Domain Services ‚Äì Microsoft üîó Connect with Me # LinkedIn: linkedin.com/in/peter-k-a6847320b/ ","date":"21 August 2025","externalUrl":null,"permalink":"/about/","section":"Deathstalker","summary":"","title":"About Me","type":"page"},{"content":"","date":"21 August 2025","externalUrl":null,"permalink":"/","section":"Deathstalker","summary":"","title":"Deathstalker","type":"page"},{"content":"","date":"23 September 2023","externalUrl":null,"permalink":"/tags/forensics/","section":"Tags","summary":"","title":"Forensics","type":"tags"},{"content":"","date":"23 September 2023","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"","date":"23 September 2023","externalUrl":null,"permalink":"/tags/web/","section":"Tags","summary":"","title":"Web","type":"tags"},{"content":"","date":"23 September 2023","externalUrl":null,"permalink":"/writeups/","section":"Writeups","summary":"","title":"Writeups","type":"writeups"},{"content":"Waiting to be published\u0026hellip;\n","date":"16 August 2023","externalUrl":null,"permalink":"/soc/disk_forensics/","section":"Socs","summary":"","title":"Digital Forensics.","type":"soc"},{"content":"Incident Response is an approach for managing cyber security incidents(DOS, Social Engineering, Ransomware). It involves a set of structured processes that help in quicky identifying, containing and recovering from cyber incidents efectively minimizing the damage and reducing downtime on an organization\u0026rsquo;s operations.\nAn Incident Response plan is a documented guidline - specific for an organization - that outlines the procedures to follow when facing a cyber incident. It clarifies different roles and responsibilities and guides on the various activities to be taken.\nFacing an incident without a proper plan is stressful. You lack guidance on how to proceed and what to prioritize. This leads to delays and increaed damage.\nThe IR Process \u0026amp; Life Cycle # The IR process may differ from organization to organization based on the framework used but the key stages remain as stated below.\nPreparation - this is the initial phase that involves getting ready for an incident by trainning the IR team, acquiring the necessary tools and resources to handle any incident to come, defining communication strategies and even outlining everyone\u0026rsquo;s roles and responsibilities. Everyone will be hacked, it\u0026rsquo;s just a matter of when not if. This stage allows organization\u0026rsquo;s to create a robust defense mechanisim. This may involve risk assessments to determine what\u0026rsquo;s potentially vulnerable, configuring tools and technologies ready to protect against malicious activity and user awareness and training on appropriate individual security according to the organization starndards.\nIdentification - No matter how well-prepared you are, there\u0026rsquo;s always a chance that a new and unexpected threat could emerge or an employee clicking that phishing link. This phase involves detecting and identifying any indicators of compromise. This could be achieved when a SIEM solution alerts on unusual traffic or an AV product alerting on malware execution. Incident identification would be an easy peasy if every alert were a guarantee of a compromise. Unfortunately, false positives arises and the identification process relies on the man on the ground. The IR team. To proper recognize compromises security teams need to have strong skill sets in understanding of the normal network behaviour and correlating evemts.\nContainment - We are under attack. What do we do now? Should we declare a state of emergency and shut down everything? Well, once an incident is confirmed, it\u0026rsquo;s important to take action to prevent wider spread an infection. This phase involves temporary response to incidents to decrease impacts. Containment stategies my vary depending on the incidents but be wary of turning devices off without full identification of what\u0026rsquo;s compromised. When not carefull some containing strategies may result to the attacker causing more damage. Containment may involve isolating all infected hosts or transfering them to a different VLAN. In cases of phishing attacks, it may require blocking the originating Ip address.\nEradication - After containing the incident, this step is where you dig deep to identify the root cause of the incident and removing it. It may involve deleting the malware, disabling breached uer accounts, as well as identifying exploited vulnerabilities and performing a system patch. Signatures are also created in this phase.\nRecovery - after the threat has been eliminated, it\u0026rsquo;s time to restore systems to normal operation. It may involve restoring backups and rebuilding sytems.\nLessons Learned - this is often called the post-incident activities that aim to improving the organizational security measures by reflecting on the incident. What happened? What could have been done better to prevent this? What should improve? What additional tools do we need? In this phase, the IR team updates their playbooks so that they don\u0026rsquo;t suffer from the same incident again.\n","date":"16 August 2023","externalUrl":null,"permalink":"/soc/ir/","section":"Socs","summary":"","title":"Incident Response(IR).","type":"soc"},{"content":"Waiting to be published\u0026hellip;.\n","date":"16 August 2023","externalUrl":null,"permalink":"/soc/splunk/","section":"Socs","summary":"","title":"Introduction to Splunk.","type":"soc"},{"content":"Waiting to be published\u0026hellip;.\n","date":"16 August 2023","externalUrl":null,"permalink":"/soc/windows_event_logs/","section":"Socs","summary":"","title":"Introduction to Windows Event Logs.","type":"soc"},{"content":"Waiting to be published\u0026hellip;..\n","date":"16 August 2023","externalUrl":null,"permalink":"/soc/memory_forensics/","section":"Socs","summary":"","title":"Memory Forensics.","type":"soc"},{"content":"","date":"16 August 2023","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"},{"content":"Waiting to be published\u0026hellip;.\n","date":"16 August 2023","externalUrl":null,"permalink":"/soc/siem_usecases/","section":"Socs","summary":"","title":"SIEM Use Cases.","type":"soc"},{"content":"","date":"16 August 2023","externalUrl":null,"permalink":"/series/socs/","section":"Series","summary":"","title":"Socs","type":"series"},{"content":"","date":"16 August 2023","externalUrl":null,"permalink":"/soc/","section":"Socs","summary":"","title":"Socs","type":"soc"},{"content":"","date":"15 August 2023","externalUrl":null,"permalink":"/tags/ceasar/","section":"Tags","summary":"","title":"Ceasar","type":"tags"},{"content":"","date":"15 August 2023","externalUrl":null,"permalink":"/tags/cipher/","section":"Tags","summary":"","title":"Cipher","type":"tags"},{"content":"","date":"15 August 2023","externalUrl":null,"permalink":"/tags/cryptography/","section":"Tags","summary":"","title":"Cryptography","type":"tags"},{"content":"","date":"15 August 2023","externalUrl":null,"permalink":"/posts/","section":"Posts","summary":"","title":"Posts","type":"posts"},{"content":" Security Information and Event Management is a solution for managing an organization security posture by providing a centralized platform that monitors and consolidates multiple security related events withing an orgnization\u0026rsquo;s network. The SIEM solution build up from 2 key components.\nSecurity Information Management(SIM) - this involves collecting all data from different log sources and end devices in the organizational network(firewall logs, system logs, application logs, web logs..etc) then stores them in a central repository or database where it can later be analyzed. Security Event Management(SEM) - SEM focuses on monitoring, evaluating and correlating events as they occur. this helps in identifying occurences of suspicious events like(unauthorised logins) in real time thus improving the incident response process. SIEM Components # Log collection \u0026amp; Aggregation - involves collecting, parsing and normalizing logs and event data from various sources(end user devices, network devices, servers, etc) using special programs called agents. Log Management - responsible for receiving log data from different sources, indexing and storing in a central repository ready to be accessible for analysis. Security Monitoring - this involves analyzing event data against pre-defined correlation rules to identify patterns and alert when unusual activities occur. Consider a scenario where you would like to detect a brute-force attach against a web server. Brute-force attack happens when an attacker repeatedly tries multiple usernames and passwords till they gain unauthorised access. A correlation rule here could perhaps be configured to detect multiple login failures on an account withing a short period of time and trigger an allert. Visualization and Analytics - this involves representing recurity events in visual form and dashboards. Visual representstions like charts and graphs offer direct insights when analyzing data and helps monitoring security trends and metrics. Icident Response - SIEMs may offer tools to facilitate incident management procedures. This may involve forensics analysis on host or containment and isolation of infected devices. Threat Intelligence - SIEMs may integarate with threat intelligence feeds to enrich the analysis process by providing more information about the attacks like the tactics and tecniques used. Architecture # Image\u0026hellip;\nTools # There are a dozen of SIEM tools in the industry today. Some are free and others are paid. They all basically try to achieve the same thing but what really differentiates them is their data collection reach and correlation.\nSPLUNK - IBM Qradar - Log Rhythm - ELien Vault - Elastic Serch - Next time we\u0026rsquo;ll take a practical look on one of these tools; Splunk. We\u0026rsquo;ll learn what it is, how it\u0026rsquo;s deployed and how it\u0026rsquo;s used. See ya \u0026#x1f603;\n","date":"11 August 2023","externalUrl":null,"permalink":"/soc/siem_architecture/","section":"Socs","summary":"","title":"SIEM","type":"soc"},{"content":" Logs are records about the events and activities occuring within a computer system, network or applications. These records provide a chronological account of what has happened within a system. It could be errors raised by an application or what was recently downloaded and when.\nLogs are the heart of SOC operations. They offer visibility on systems, devices, application, users activities within a network which empowers SOC analysts to monitor, detect and respond to suspicious activities.\nLog file - a file containing log records.\nLogging - the act of keeping a log file. Events # An event is any occurrence that the operating system (OS) or a program wants to keep track of or alert the user about.[cybertalents] Examples of events are:\nLogon Events - when a user login/logout of a computer system. User events - when an account is created in a system or a password is changed. Event logs are special files that record important events on a computer system.\nLog types # Security Logs - there track security related events like user logins, access control changes(permissions \u0026amp; roles) and security policy violations. System logs - record system-level events such as startups, shutdowns and hardware changes. Application logs - record errors, crashes encountered by application and user interactions with an application. Network logs - these capture network related events such as networrk traffic(Ip address, ports and protocols), successfull connections, blocked requests and network firewalls activity. Web Server logs - record details about HTTP requests, responses and accessed resources. It also captures issues encountered by the web server while processing requests. Event classification # This is the process of categorizing various events and event data based on a specific criteria. Events are classified as:\nError - error events indicate a significant problem such a failure in system or application. they require immediate attention and respone to restore functionality. Warning - these signify potential issues that may lead to a problem in the future. Informational - these just provide status updates like a successfull login or a successful system update. Log attributes # Timestamp - the date and time when the event occurred. Source - the application, system or component that generated the event. User/Entity - the user or process responsible for the event. Description - a brief detail of what happened. ","date":"5 August 2023","externalUrl":null,"permalink":"/soc/introduction_to_logs/","section":"Socs","summary":"","title":"Introduction to Logs.","type":"soc"},{"content":"Last time we discussed various authentication methods(SPF, DKIM, DMARC) used in email and also explored the various email headers that offer insightful information about the email. Today we are going to take a practical approach to analysis and investigate the email headers of one malicious email.\n\u0026hellip;..to be published\n","date":"3 August 2023","externalUrl":null,"permalink":"/soc/email_analysis/","section":"Socs","summary":"","title":"Email-Based Phishing - Analysis","type":"soc"},{"content":"Path traversal vulnerability, also referred to as directory traversal, allows attackers to navigate beyond the web application publishing directory and traverse multiple levels up the directory structure. This flaw enables unauthorized access to sensitive files and directories outside the intended scope.\nThis vulnerability arises when the developer designed the application to load resources by directly appending the file name to the web root folder (/var/www/html/). This allows an attacker to use . . / (dot dot slash) to step one level up the directory(/var/www/html/../). The atacker can chain this payload like this ../../../ect/passwd allowing them to traverse to the top(/) of the directory structure and view the /etc/passwd file which is a sensitive file in linux that lists all users in the system.\nLab # Consider the shoping application below. You can access the Lab from Portswigger - Directory Traversal.\nWhen we click view details and intercept the web request with burpsuite, we see the application retrieving the product image as below.\nLet\u0026rsquo;s modify the request and see if we can step directories up and ask for other files. When we request for ../../../etc/passwd we can see that we are served with the contents of the passwd file.\nSometimes an application might try to strip out the . . / character to prevent this attack. Nevertheless, an attacker can nest the sequence this way . . . . / / to ensure once the inner one is stripped the traversing sequence remains.\nAttackers may also use URL encodings to bypass filters in place.\nSoppose an application restricts file retrievals to ones with specific extensions(.png). A null byte character (%00) could be used to terminate the filename and bypass the check with( . . / . . / . . /etc/passwd%00.png). The application will be fooled that the file is a png file while the operating system will terminate the filename at /etc/passwd.\nIn a SOC Analyst perspective, detecting directory traversal exploitation involves monitoring http requests for patterns like . . / / or their respective encoded versions %2e%2e%2f.\nMitigation # Input validation - all users input must be checked to ensure they do not contain any directory traversal sequences. Canonicalization - ","date":"27 July 2023","externalUrl":null,"permalink":"/soc/path_traversal/","section":"Socs","summary":"","title":"Directory Traversal","type":"soc"},{"content":" Why bother break into a system while owners can willingly give you the password?\nEmail-based phishing has emerged the most porpular social engineering technique used by cyber criminals to harvest users credentials and distribute malicious payloads. Utilizing fear, urgency, and curiosity in emails has become the favored approach for cybercriminals to entice more users into clicking on malicious links or downloading attached malware. Today, we are going to learn how emails work.\nStructure # Protocols # The following are the 3 primary protocols used in email communication:\nSimple Mail Transfer Protocol(SMTP) - SMTP operates on port 25 and is responsible for the transmission of outgoing emails. When a user sends an email, the email client(gmail,outlook..) uses this protocol to send the email to the recipient mail address. Post Office Protocol 3(POP3) - POP3 is an email retrieval protocol used by mail clients to retrieve emails from a mail server. It operates on port 110. Once the email client downloads the email from the mail server, the email is deleted from the mail server. No other device can access it. Emails can only be accessed by the first device that downloaded it. This protocol is not so efffective when you need synchronization of messages in your mail box across multiple devices(tablet,laptop, smartphone). Internet Mail Access Protocol(IMAP) - IMAP is another email retrieval protocol that allows users to access emails from multiple devices while keeping the emails synchronized across all devices. When you access your email using IMAP, the server retains your emails, and any changes you make (read, delete, move) are synchronized across all your devices. IMAP operates on port 143. Email Authentication Protocols # The email authentication protocols are mechanisms set to to help prevent email spoofing, phishing and other email-based threats. They work together to verify the integrity and authenticity of emails.\na.) Sender Policy Framework(SPF) - this protocol allows the owner of a domain to specify which mail servers are authorized to send emails. \u0026ldquo;Spammers can forge your domain or organization to send fake messages that appear to come from your organization. This is called spoofing. Spoofed messages can be used for malicious purposes. For example spoofed messages can spread false information, send harmful software, or trick people into giving out sensitive information. SPF lets receiving servers verify that the mail that appears to come from your domain is authentic, and not forged or spoofed\u0026rdquo; - Google. For example the SPF record below specifies that the domain mail.allsafe.com is allowed to send emails on behalf of allsafe.com . When an email is received the recipient\u0026rsquo;s mail server can check the SPF record of the sender\u0026rsquo;s domain. If the sending mail server\u0026rsquo;s IP address matches one of the authorized servers listed in the SPF record, the email passes the SPF check otherwise it fails. Based on the result of the SPF check the following actions may be taken:\npass - SPF check is successful; the mail server is authorized to send emails. None - No SPF record was found. Neutral - The SPF record doesn\u0026rsquo;t explicitly authorize or reject the email. Soft fail (~ all) - SPF check failed(suspicious). The mail may be sent to spam/completely rejected based on the DMARC policy set(See DMARC below) Hard Fail (- all) - The email should be rejected because the mail server is not authorized to send emails for the domain. b.) Domain Keys Identified Mails(DKIM) - this is a cryptographic authentication method that allows the receiver to verify the integrity and authenticity of the email\u0026rsquo;s content through digital signatures. The sending mail server signs the email with a private key, and the recipient\u0026rsquo;s mail server uses the corresponding public key advertised in the domains\u0026rsquo; DNS records to verify that the emai\u0026rsquo;s content has not be tampered with during transmission.\nc.) Domain-based Message Authentication, Reporting and Conformance(DMARC) - allows domain owners to define policies for handling emails that fail SPF and DKIM checks. How should the recipient server treat emails that failed the authentic check? DMARC policies include:\nNone - Take no action on failed authentication. Monitor and observe. Quarantine - Treat emails that failed authentication as suspicious and store them in Spam folder to prevent the recipient from falling into a potential phishing attempt. Reject - DO NOT DELIVER all emails that fail authenticity check. To learn mor about these methods of authentication please refer to Email authentication: How SPF, DKIM and DMARC work together - by Peter Loshin.\nEmail Headers # The email headers section of an email message contains the metadata(data about data) of the email(like origin, destination, date, etc..).\nDelivered-To - indicates the receipient email address. Return path - Also known as the bounce address, it specifies where the email should be sent incase it is not delivered. Received-SPF - added by the recipient\u0026rsquo;s mail server to the email\u0026rsquo;s header to record the result of the SPF check(pass, fail, soft-fail). From - dsplays the senders address. It can easly be forged and should not be trusted. To - displays the name of the receiver. Date - displays the date and time when the email was sent. Subject - displays the Subject of the email. Message-ID - a unique identifier of the particular email assigned by the senders mail server. Content-type - specifies the format of the email body(plaintext, xml, HTML) MIME-Version - the Multipurpose Internet Mail Extensions (MIME) version used in the email. MIME extends the capabilities of email messages to support various types of content beyond plaintext(attachments, images). X-Headers - allow senders to include additional information in email headers beyond the standard headers. For example, X-Mailer shows the email client used to send the email, X-Antivirus states the senders anti-virus programme. It\u0026rsquo;s essential for us SOC analysts to understand the anatomy of emails inorder to better identify suspicious emails. Next time we\u0026rsquo;ll dive into Email header analysis. The Email headers contains valuable information about the email. These header properties values may help us identify perhaps signs of spoofing like when the FROM value differs from the senders domain. We\u0026rsquo;ll also analyze the email body verifying all attachments and links and diserning subtle cues of deceit and maliciousness.\nLet\u0026rsquo;s keep doing what we know how to do best; learnig how fortify our cyber defenses. Se ya! \u0026#x1f603;\n","date":"27 July 2023","externalUrl":null,"permalink":"/soc/email_anatomy/","section":"Socs","summary":"","title":"Email-Based Phishing - Anatomy","type":"soc"},{"content":" Structured Query Language is the language used to interact with relational databases.\nRelational databases are databases whose data is stored in tabular format. Each record of data is a row with multiple column fields.\nSQL offers the folowing statements for managing relational databases.\nSELECT statement - retrives records from a table. SELECT column1, column2 FROM table_name SELECT * FROM table_name (retrives records for all columns) UPDATE statement - modifys existing records in a table. INSERT statement - creates records in a table. DELETE statement - removes records in a table. What is SQL Injection? # SQL injection (SQLi) is a web security vulnerability that allows an attacker to interfere with the queries that an application makes to its database [portswigger]. An attacker could include malicious SQL payloads inside SQL queries which may allow them to gain un-authorised access or retrieve sensitive information.\nBypass Login # Consider an application login module that takes a username and a password then performs a SELECT query (SELECT * FROM users WHERE username = '$username' AND password = '$password) and if records with the given credentials are found the user is logged in. The attacker could submit the string Admin' OR 1=1 -- as their username and any password. The single quote ' will close username string and the boolean condtion 1 = 1 will make the whole query return True since 1=1 is True(returning all users in the database). The double dash -- is a character used in MySQL for comments. This will force the final part of the query to be commented out thus disabling the password check and granting a successful login as the Admin. Retrieving Data from other tables # The Union operator is used in SQL to combine results from 2 SELECT statements. The results MUST be compatible with each other (Same number of columns and data type).\nAn attacker could abuse this keyword and perfom a UNION-Based SQL injection to retrieve records from other tables. Because of the compatibity problem, the attacker must first know the number of columns return by the original query. This is important to ensure a successful attack.\nNULL - the NULL keyword is used to represent missing data or unknown values in databases.\nIn quest for the number of columns for the original query, the attacker can retrieve NULL for columns in the injected query while observing the server responses for errors.\nNOTE: When i say original query i refer to the legitimate query made by the database that the attacker aims to interfere with. When i say injected query i refer to the payload the attacker includes in the original query.\nSuppose an online shopping application performs the query below to filter displayed products based on user\u0026rsquo;s input in the search bar (say electronics).\nThe attacker can inject the payload ' UNION SELECT NULL -- then observe for databases errors or generic errors. MySQL usually returns The used SELECT statements have a different number of columns. With this the attacker can gradually increment the NULLs for columns and when the number of columns are matched the application will often respond since an extra row of nulls would have been be included in the result set.\nWhat happens after an effective column count?? Let\u0026rsquo;s say the attacker identifies that only 3 columns are returned(say product name, description and price). They further would want to determine the datatypes of these columns. They do this by placing a string value at each place of the column and observes errors when the query breaks because of conversion failures.\nNote: When you select a string on a column that expects an integer the conversion \u0026quot;string to int\u0026quot; cannot be done. Intergers can be converted to strings.\nFor our example, the attacker will encounter no errors therefore finding out all the 3 columns can take a string value. If the attacker knows that there exists a table called users which contain columns username and password, they can inject the payload 'UNION SELECT username, password, NULL FROM TABLE users-- and all users credentials would be leaked and displayed together with the electronics products.\nHow would they know what tables exist? # Before executing their prefered statement, the attacker can start by gathering information about the database. To determine the database version the attacker can query SELECT @@version. This will work for MySQL/Microsoft databases. Here\u0026rsquo;s a list of different queries to determine the database version for particular database management systems. They could try all these till they get that which works.\nFor most relational databases the information_schema contains information about tables within each database and even columns for each table. With the pyload below the attacker can retrieve all table names within a database. Once the attacker identifies interesting tables(say users_credentials) they can use the payload below to return all column names for that table.\nFinaly they can retrieve specific columns from that table with:\nAnd just like that! Pew Pew! \u0026#x1f606;\nSQL injections can be more complex than just the error based we\u0026rsquo;ve discussed. In cases where the application doesn\u0026rsquo;t generate errors an attacker could employ advanced higher order SQL injection and perhaps cause Time delays for the responses allowing them to infer the existence of this vulnerability based on the delay.\nFor more on SQL injection please check out the Web application Security academy by portswigger! Also Rana Kalil has an awesome youtube channel where she covers many web app vulnerabilities in detail.\nSQL injection vulnerabilities can have devastating impacts to an organization like authorised access, sensitive data exposures and more.\nMitigating SQLi # Sanitize users input - Never trust the user. Validate all inputs from the user to ensure that user-provided data meets expected formats and does not contain malicious characters or SQL keywords. Use parametized query(prepared statements) - prepared statements ensures that the input parameters are separated from the SQL query. The query only contains place holders. As SOC analysts, to detect when this vulnerability is being exploited, we can monitor client requests for SQL injections patterns like bolean expressions and suspicious characters like single quotes. Attackers may obfuscate their payloads as ascii characters making it hard to detect. Tools like WAF can really help alert for any SQL injections attempts.\nNext time we\u0026rsquo;ll explore the Directory traversal vulnerability in brief. This vulnerability allows attackers to navigate through folders and access files out of scope. See you next time! \u0026#x1f603;\n","date":"27 July 2023","externalUrl":null,"permalink":"/soc/web_attacks/","section":"Socs","summary":"","title":"SQL Injection","type":"soc"},{"content":" An endpoint is any device that is connected to a network; from laptops, PCs, servers, smart phones to all IoT devices and more. The number of endpoints in networks today has exploded. Todays\u0026rsquo; policies like BYOD(Bring Your Own Device) that allow employees to use their personal devices to access co-operate resources together with the remote workforces which has recently become the new norm - have greatly increased the attack surface.\nAttack surface refers to a potential entry points and weaknesses that attackers could use to gain unauthorised access to systems. Basically all ways to break into a system. Every endpoint connected to the co-operate network is a gateway for cyber criminals to inflict more pain.\nWhat is Endpoint Security? # Endpoint security is the approach to protect and secure all these devices that connect to the network from cyber threats. It includes the tools and technologies set to detect and defend the end-user devices from all sorts of malicious activity.\nEndpoint Security Controls # Host Based Intrusion Detection System(HIDS) - this is a system that monitors and analyses activities on an endpoint device based on predefined signatures(characteristics that identify specific known threats) and alerts security personel. It also logs those activities for further later investigation. One example of a popular HIDS is OSSEC.\nHost Based Intrusion Prevention System(HIPS) - this system is simillar to HIDS but with added ability to take actions like blocking and shutting down identified threats to contain them.\nAnti-Virus(AV) Products - Also known as Anti-virus softwares, they protect devices from malwares and viruses. There are 2 types of AV solutions:\nSignature Based - these operate on a large database of \u0026ldquo;known-bad\u0026rdquo; malware signatures. Its detection involves comparing files and applications against these signatures and if a match hits they have the ability to delete that file, alert the user or take appropriate action. Note that a solution like this that relies on a list of signatures for known malicious files isn\u0026rsquo;t so efficient in identifying new and previously unknown attacks(Zero day exploits). Behavior Based - this other type focuses on analyzing the behavior of programs rather than relying on predefined signatures. This AV type documents the normal activity and then monitors the system to identify any software that can be performing any abnormal activities and then takes an action against it[cybertalents]. Host Based Firewalls - unlike network firewalls that protect the entire network, host based firewalls are designed to secure a single endpoint such as a PC. They have the ability to control applications communicating over the network. Endpoint firewalls can block ports, filter traffic based on predefined rules and generate logs and alerts whenever they detect security threats. These logs are valuable for further forensics analysis.\nEndPoint Detection and Response(EDR) - this is an advanced technology with similar functionality as HIDS and HIPS. EDRs offer continous monitoring, analysis of endpoint activities and collection of all these data. It has the ability to contain incidents and take actions like alerting and stoping malicious programs. In cases of confirmed attacks this tool has the ability to isolate all infected machines from the network. This tool works to reduce the attacker\u0026rsquo;s dwell time and to speed the Incident response process.(We\u0026rsquo;ll talk about the Incident Response process in future!)\nComponents of an EDR\nData collection agents - these are softwares that collect data like file changes, processes running and network activities from the endpoints. Automated Response rules - these are pre-configured rules that identify whether a certain activity is a threat or not and automatically take an action against it [cybertalents]. Forensics Tools - these are tools used by security analysts to investigate incidents or even to perform a threat-hunting process [cybertalents]. Vulnerability Management and Compliance - this is a process that involves scanning endpoints regularly and performing vulnerability assesments to identify potential weakness and mitigate them before the attacker does. Offense in the best defense. Types of vulnerability scans: External Vulnerability scans - this scan is performed with zero privileges to the system and it aims to identify possible entry points from the attackers view. Internal Vulnerability scan - this type of scan is done inside the organization\u0026rsquo;s network where the scanner already has an access to the system. It covers even co-operate devices that are not accessible over the internet. Compliance Scanning - when something is compliant, it means it meets all the required standards and regulations set in it\u0026rsquo;s specific context. Compliance scanning focuses on industry\u0026rsquo;s regulatory requirements. An example of these regulations is HIPAA(Health Insuarance Portability and Accountability) which sets guidlines and requirements for maintaining privacy of individual\u0026rsquo;s health information. Compliance scan should be done regulary to ensure all endpoints meet the necessary regulatory obligations.\nEndpoint security is very critical. And, safeguarding individual devices from the cyber adversaries is yet another way to strengthen the organization\u0026rsquo;s overall cybersecurity resillience. In future series we\u0026rsquo;ll discuss OSSEC ; an open source Host Based Intrusion Detection System and also talk about the Linux Firewall and how we can utilize the iptables utility to write firewall rules to deny traffic. But before that, we are going to shift to something new next time \u0026ndash; the fascinating world of Web Security \u0026ndash; how to protect web applications that are open to the world. We will start slow with how web works but ramp fast to the top ten web attacks and how to mitigate them.\nSee you next time! \u0026#x1f603;\n","date":"21 July 2023","externalUrl":null,"permalink":"/soc/endpoint_security/","section":"Socs","summary":"","title":"Endpoint Security","type":"soc"},{"content":"According to the 2023 Verizon Data Breach Investigations Report (DBIR), Web application attacks account to approximately 25% of the total breaches in today\u0026rsquo;s threat landscape. Web applications have become the primary way for organizations to interact with customers from E-commerce, Marketing to Financial transactions and Healthcare services. It\u0026rsquo;s vital for SOC analysts to understand web attacks to effectively detect them. Today we\u0026rsquo;ll go through the common web attacks; our main focus will not be about exploring the different hacktricks to exploit them but rather the defense against them.\nUniform Resource Locator(URL) # A URL is a unique identifier of a web resource through which that recource can be retrieved[The Web application Hackers Handbook]. It\u0026rsquo;s basically just a way to specify where a particular resource(image,file etc) is. URL\u0026rsquo;s follow the following format:\nprotocol://domain_name:port/path_to_file/?query=value#fragment\nprotocol - https,https,ftp\u0026hellip;. domain-name - the server where the resource is located e.g google.com, netflix.com port - this one is optional incase an application doesn\u0026rsquo;t use the default port(http,https = 80,443) path - location on the server where a specific resource is located.(/images/latest/) query - used to pass data to the server when making a request. Goes after the ?. Takes the key=value form.(?size=small) fragment - identifies a specific section withing the resource\nHow web works! # The world wide web uses the HTTP protocol to communicate. This protocol facilitates data exchange between a client and a server in form of requests and responses. When a user types in a URL in the web browser, the browser initiates an HTTP request to the web server which then replies with an HTTP response.\nHTTP Requests # HTTP requests are stateless, meaning the server does not maintain any sessions. Once a request is made to the server and a response is received the connection is closed and the next request is treated as an independent request. The first line of every HTTP request contains a verb (indicating HTTP method), the requested URL and the HTTP version.\nHTTP Methods # GET - used to retrieve resources POST - used to submit data (login credentials, form data\u0026hellip;) PUT - used to update an existing resource. The server replaces the current resource with the new one. DELETE - used to remove specified resource HEAD - same as GET but the server response does not contain the body. TRACE - used for diagnostics purposes. OPTIONS - used to view the HTTP methods that can be used for a particular resource. Some HTTP Request Headers # Host -specifies the Host name Accept - specifies the kind of content the client is willing to accept. Accept-Encoding - specifies the ype content encoding the client is willing to accept User Agent - provides information about the browser or other client soft- ware that generated the request. Referer - speciÔ¨Åes the URL from which the current request originated. For more on HTTP headers please check out this article More on Headers.\nHTTP Responses # The first line of any http response contains the HTTP version, a status code and a phrase describing the status(OK,NOT FOUND\u0026hellip;.). HTTP responce headers follow then the body.\nSome HTTP Response headers # Server - provide info about the web server being used. Content-Type - specifies the type of the content in the response body. Content-Length - species the length in bytes of the body. Connection - specifies whether the TCP connection should be closed after the transmission is complete. Location - used in redirection responses to specify the target of the redirect. Status Codes # Status codes indicate the result os the request. They fall into 5 classes based on the first digit of the code.\n1xx - Informational - the client should continue with the request. 2xx - Successful - the client‚Äôs request was successfully received, understood, and accepted.(200 OK, 201 CREATED) 3xx - Redirection - indicate that the requested resource is temporarily or permanently moved to a different location. 4xx - client error such as resource not being found, client not allowed to access the resource or authentication is required. 5xx - Server error - The server is aware that it has erred or is incapable of performing the request. For more on HTTP response status codes, please check out this article Response status codes.\nAs a SOC analysts, the status codes can be very insightful in detecting potential attacks. If you encounter a large number of 404(Not Found) errors, it could be a sign of directory enumeration. Frequent 401 (Unauthorized) responses may indicate access attempts or failed authentication attacks(Login bruteforce attacks). Unusually high occurrences of 503 (Service Unavailable) status codes may indicate a DoS or DDoS attack targeting the server\u0026rsquo;s resources.\nOWASP TOP 10 # The Open Web Application Security Project (OWASP) Top 10 is a document that lists the ten most critical web pplication security risks. It\u0026rsquo;s updated every 5 years with new critical vulnerabilities. Brocken Access Control - this vulnerability occurs when authorization is broken. This offers unauthorized users permissions to access sensitive information that they shouldn\u0026rsquo;t(e.g Being able to acces other users data). Cryptographic Failures - this vulnerability occurs when cryptographic mechanisms are improperly implemented or use of weak algorithms(use of isecure hases like MD5 algorithm). Injection - injection vulnerability occur when there is no validation of the inputs users type. This opens up for malicious actors to inject malicious code or commands and execute them leading to unauthorized access(SQL injection, Code Injection). Insecure Design - this vulnerability arises from the logical design of the application. Attackers could bypass the logic and gain unauthorised access. Security Misconfiguration - occurs when applications and servers are not properly configured to achieve security(leaving default passwords, exposing unneccessary open ports). Vulnerable and outdated components - this arises when an application uses outdated softwares, packages and dependencies that my nolonger be supported by the developer. This makes them risky and vulnerable. Identification and Authentication Failures - this comes with weak authentication(verifying users that they are who they say they are) e.g Weak passwords that could easily be brute-forced. Software and Data integrity failures - When an application relies upon plugins, libraries, or modules from untrusted sources it poses a risk to the application. The whole company\u0026rsquo;s software could be built on a malicious code. Security Logging and Monitoring failures - without logging and monitoring it becomes a challenge to identify and respond to threats in real time. Server Side Request Forgery - SSRF flaws occur whenever a web application is fetching a remote resource without validating the user-supplied URL[owasp]. Say an application allows users to input a reference link to an image to be used as their profile photo rather than uploading. An attacker could misuse this and reference say https://127.0.0.1 which enables them to access the server from it\u0026rsquo;s localhost. Web Application Firewalls(WAF) is the technology devised to protect web applications from these threats. It monitors all the incoming requests and only allow the legitimate ones. WAFs also generate web traffic logs for both allowed and denied requests. These logs are a great source for incident investigations.\nWeb Application Scanners A web application scanner is a software tool that is designed to crawl websites and identify vulnerabilities in web applications. Here\u0026rsquo;s a list of the most common ones in the industry Web scanners. Challenge Time! # We\u0026rsquo;ll be solving beansdetector challenge from cybertalents. The file is a log file fron a WAF. If we look at the first few lines, just like most logs it follows a pattern: IP ADDRESS, DATE, HTTP_METHOD, FILE_REQUESTED, HTTP_VERSION, RESPONSE_BYTES, WEB_SCANNER\nThere are alot of 404 status codes which indicate directory enumeration. The attacker was trying to discover all pages, files and directories that can be accessible from the web application. For successful attacks we must investigate the successful requests with status code 200 OK. The attacker was able to discover some few files withing the web application and the last record below shows us an interesting file that was exposed. Use the flag format above to construct the answer!\nThat\u0026rsquo;s all for our introduction to web application security. Next time we\u0026rsquo;ll focus on the attacks, showcase some exploit examples and how to mitigate them! See you next time!\u0026#x1f603;\n","date":"21 July 2023","externalUrl":null,"permalink":"/soc/intro_to_web_security/","section":"Socs","summary":"","title":"Introduction to WebApplication Security.","type":"soc"},{"content":" Last time we covered the practical tips of Wireshark, a Graphical User Interface(GUI) tool for anayzing network packets. We enjoyed it\u0026rsquo;s powerful and very user-friendly interface where we could just click buttons to utilize it\u0026rsquo;s features. Well, sometimes as SOC analysts we may need to perform network analysis on headless servers and remote enviroments where we lack the ability to operate with GUI-based tools. Othertimes we may want to automate our analysis by writing scripts and utilize other tools in our OS to aid in analysis. And for most times, we may want to run our monitoring for a very long time and it would be fair if we could have a tool with similar abilities as wireshark that can run in the background for as long as we need. Developed by Wireshark, Tshark offers a commandline alternative for Wireshark. It\u0026rsquo;s designed to be lightweight; consumes less resources and offers additional ability to use the commandline pipe and pass results to other tools. Just like Wireshark T-shark can capture packets, filter and even generte network traffic statistics.\nInstalation # If you installed Wireshark in windows, open the commandline and navigate to the Wireshark directory. From there you can run tshark. For Linux distributions use sudo apt get install tshark.\nTshark Options # To explore the available Tshark options use tshark -h.\n-v - prints the version of Tshark.\ntshark -D lists all the interfaces available for capture.\nTo capture traffic on a specific interface, you specify the interface using the -i option followed by it\u0026rsquo;s ID or name e.g tshark -i 1 or tshark -i wlan0. We may need to generate some traffic before we start seeing packets flow. I\u0026rsquo;ll ping the google DNS server. Appending the --color option, lets you colorizes the traffic.\nTo capture exact amount of packets we use the -c option for count. Tshark will stop capture after the packet count is reached.\nThe Verbose Mode specified by the -V option shows us more details about each packet. It\u0026rsquo;s similar to the Packet details pane in wireshark.\n#### Capture Filters Capture filters selectively include or excludes packets based on the specified criteria. In Tshark, capture filters are specified using the **-f** option. It uses similar filters like the ones we discussed in wireshark e.g by port `tcp port 80`. Checkout this [cheat-sheet](../files/Wireshark%20Cheat%20Sheet-1.pdf) Writing to a file # Rather than displaying packets on the console, Tshark has the ability to write captured packets to a file when the -w option is specified. This option takes the file name.\nWriting to Multiple files # We can also split captures to multiple files using the -b option for buffer. Splitting may be based on:\nfilesize: switch to the next file after the given size limit(KB). files: maximum number of files. duration: split after a number of seconds.\nAlso note that the file number and a timestamp are added to the filename.\nReading from a file # The -r option reads packets from a specified capture file (PCAP or PCAPNG format).\nTo apply display filters use the -Y option. Display filters are the same as used in wireshark. Check cheat sheet above e.g dns, tcp, ip.address==10.1.1.2\nOutput formats # There are different output formats available to display packets details(e.g text, json, pdml). Output formats are specified using the -T option.\nLet\u0026rsquo;s try tabs!\nStatistics # Just like wireshark, Tshark too offer network statistics like conversations statistics, endpoint statistics, protocol hierarchy statistics and even packet lengths statistics. Statistics options are availble with the -z option.\nProtocol Hierarchy stats(PHS) # PHS displays a distribution of protocols in the capture. Using the option -z followed by io,phs we can summarize a trace file by a breakdown of protocols.\ntshark -r packetcapture.pcap -z io,phs\nPacket Lengths statistics # These statistics provide insights into the distribution of packet lengths in the network traffic. It helps identify anomalies, such as unusually large packets.\ntshark -r packetcapture.pcap -z io,pls\nWe also have the ability to look at specific protocol tree distribution. For example if we consider HTTP requests, we get an analysis of the Status codes distributions. tshark -r packetcapture.pcap -z http,tree\nTry to explore more on conversations and endpoints!! For a detailed guide on Tshark, check this book by Hacking Articles Tshark Guide.\nChallenge Time! # We will be solving a challenge called Creepy DNS from CyberTalents. I\u0026rsquo;m not allowed to share flags, so i\u0026rsquo;ll just demonstrate the process but hide the flag.\nChallenge Description: Our NMS detect a suspected traffic, your task is to investigate the captured traffic and find the anomaly reason.\nFile: dns.pcap.\nFrom the challenge, let\u0026rsquo;s filter DNS traffic and see what\u0026rsquo;s so creepy about it. \u0026#x1f61c;\nWhen a DNS client such as a web browser attempts to resolve a domain name into an IP address, it sends a DNS query to a DNS server. If the DNS server cannot find a matching IP address for the requested domain name in its records, it responds with a \u0026ldquo;No such name\u0026rdquo; DNS response.\nWe can note alot of \u0026ldquo;No such name\u0026rdquo; responses for different subdomains of cybertalents.com. A subdomain is basically a part of a larger domain that helps group and organize services e.g A company with a domain name like mycompany.com may wish to separate it\u0026rsquo;s email services to a smaller group called mail.mycompany.com. The traffic above tells us that someone tried to access subdomain names that don\u0026rsquo;t exist. If we look closely we can see single characters subdomains(Z, m, x\u0026hellip;.) that flow downloads, most of them are repeated. Could these characters together mean anything useful? Let\u0026rsquo;s find out.\nWe will use the grep tool in linux that uses regular expressions to return pattern match.\nWe\u0026rsquo;ll deal with the repeated strings later, let\u0026rsquo;s first extract just the field with the subdomains. We\u0026rsquo;ll use another tool called cut by piping the output forward. This tool extracts speficic fields characters separated by a delimeter. Our delimeter is space, and i counted the field number to be 23.\nHow about we now remove the duplicates. The uniq command will do that then, we\u0026rsquo;ll extract just the first character using the cut command but this time with -c option.\nThat\u0026rsquo;s what we needed. But, can we just remove the newlines and have a contious string? The tr command is used for transformation. Let\u0026rsquo;s use it to delete the new lines.\nOur string is base64 encoded. If we decode that, we get our flag! \u0026#x1f62e;\nNetwork analysis tools are many(Network minner, tcp dump, scapy\u0026hellip;), we won\u0026rsquo;t discuss all of them. Their workings are almost simmilar. This article wraps up our discussion on network security. Network security is a wide topic, suffice to say, a whole course by itself! We just reviewed some important sections that are handy for SOC analysts.\nNext time well uncover Endpoint Security, yet another layer in our \u0026ldquo;defense in depth\u0026rdquo;! We will learn about the technologies that are there to protect our host devices like Antiviruses and Host based fiwerwalls!\nI\u0026rsquo;d love to hear your comments and constructive critiques about this series!\nSee you in the world of Endpoint Security! \u0026#x1f603;\n","date":"20 July 2023","externalUrl":null,"permalink":"/soc/introduction_to_tshark/","section":"Socs","summary":"","title":"Introduction to Tshark","type":"soc"},{"content":" **Wireshark** is a powerful, open-source network analysis tool that allow users to capture and inspect network traffic[cybersecuritynews]. Wireshark allow users to see all communications between devices happening within a network. Wireshark can be used as a tool to sniff sensitive data like passwords flowing across a network. As SOC analysts, we'll use wireshark for forensics purposes. For most times it will be our go-for tool for analyzing saved network traffic(trace files) and investigate suspicious activities. Download and install Wireshark Here to follow along with me.\nGetting Started with Wireshark # To start seeing packets flowing we\u0026rsquo;ll need to perform a packet capture. This involves choosing from a list of network interfaces we have then click start. Once you click start, wireshark will be filled with alot of packets depending on how busy the network is.\nWireshark\u0026rsquo;s Main Windows # There are 3 panes in the wireshark's main window; packet list, packet details and packet bytes. Packet List - The packet listing pane displays a list of captured packets with various details, such as the packet number, time, source and destination addresses, protocol, and packet length. Packet Details - When you select a packet from the packet listing, the packet details pane shows the specific contents of the selected packet in hierachical form that can be expanded further. Packet bytes - The packet bytes pane displays the raw hexadecimal representation of the selected packet, allowing users to see the actual bytes of the packet. Apart from the panes we have a Menu bar at the top which contains various menus(e.g File, Edit, Analyze, Statistics..). These menus provide access to different functionalities. For example when we go to Statistics \u0026gt; Protocol Hierarchy, we able to view the distribution of traffic by protocol. What percent is TCP traffic and UDP?\nIn wireshark, Endpoints refers to devices in a network and Conversations refer to communication between 2 devices in a network. Statistics \u0026gt; Endpoints and Statistics \u0026gt; Conversations are handy wireshark functionalities that show us helpful statistics for each endpoint such as the number of packets relating to an endpoint. Let\u0026rsquo;s view the conversations for our capture.\nWe can see a list of conversations between device A and B. This list offer insights like how many packets are transmitted between two devices, how many are from A to B(A -\u0026gt; B) or (B -\u0026gt; A) and even the duration of particular conversations. This statistics is very informative especially when we are trying to identify Top talkers in a network. Top talkers are the endpoints responsibe for the most communications like our device 192.168.43.24 is engaging so much with 104.18.2.161. When you encouter conversations in your network that you know nothing about, that\u0026rsquo;s suspicious. Use the tool we discussed last time, whois , to dig more about the ownership of that IP.\nFilters # Going through all packets when analyzing traffic in wireshark is daunting, traumatizing and overwhelming. Wireshark offers two main filters that let\u0026rsquo;s us include interesting packets we only want or exclude ones we dont.\nCapture filters - these are specified during packets capture. They let us selectively capture only packets of interest to us. To set capture filters go to Capture \u0026gt; Options then write your filter expression. Filter expressions follow a specific synatx. You can filter on Ports and capture ony specific traffic through that port. e.g port 80 also you may include directions src port 80, dst port 443. You can filter on hosts and protocols too e.g icmp,udp host 192.168.43.24, dst host 8.8.8.8. To combine filters you use logical operators \u0026amp;\u0026amp; for AND, || for OR, ! for Negation e.g !UDP catures only traffic that are not UDP.\nDisplay Filters - display filters allow us to selectively view specific traffic, this makes it easier to analyze. Wireshark display filters are applied at the display filter bar.\nby protocol - icmp, dns, ftp, !http by IP address - ip.address == 192.168.43.24, ip.dst == 8.8.8.8 by Port - tcp.port == 8080, tcp.srcport == 53 combining logical operators - (ip.addr == 192.168.1.100 \u0026amp;\u0026amp; ip.addr == 192.168.1.200) \u0026amp;\u0026amp; http You can also right click on a specific packet then Apply as Filter \u0026gt; Selected to directly apply address filters. Check out this Cheet Sheet to learn more about Wireshark Filters.\nName Resolution # Wireshark has a feature called Name resolution with the ability to resolve IP address back to respective Domain names. Rather than displaying ip addresses(8.8.8.8) wireshark can be configured to display respective domain names(google.com), this makes analysis way easier. To enable this functionality, choose Edit \u0026gt; Preferences \u0026gt; Name resolution.\nResolve MAC Address - uses ARP protocol to map layer 2 MAC address to it\u0026rsquo;s associated Layer 3 IP address. Resolve Transport Names - converts a port numbr into the name associated with it e,g port 80 as http. This is handy when you encounter an uncommon port and don‚Äôt know what service is typically associated with it. Resolve IP address - converts IP address into easy-to-read domin names.\nFollowing Streams # One of the most satisfying analysis feature of wireshark is it\u0026rsquo;s ability to reconstruct data from multiple packets. This allows us to view the entire conversation between a applications and a servers.\nVarious Data Streams include:[from Practical Packet Analysis book by Chris Sanders]\nTCP Stream - Assembles data from protocols that utilize TCP, such as HTTP and FTP UDP Stream - Assembles data from protocols that utilize UDP, such as DNS. HTTP Stream - Assembles and decompresses data from the HTTP protocol. SSL Streams - Assembles data from protocols that are encrypted, such as HTTPS. You must supply keys to decrypt the traffic. We can follow HTTP streams by clicking any TCP packet then choose Follow Stream \u0026gt; HTTP Stream. HTTP traffic is not encrypted, following HTTP stream can allow us to see the contents of the conversation. Below we can see the user tried to access a webpage with the credentials shown in clear text.\nWireshark caprures can be saved in a file with File \u0026gt; Save as. Wireshark captures can also be configured to automatically stop and auto save to a file after a number of packets have been collected or for a certain number of duration in Captures \u0026gt; Options the click the output tab. Network capture files(trace file) take the format .pcap, .pcapng\nGetting our hands dirty # Time to take a practical approach and solve a network forensics challege from Cyber Defenders. We\u0026rsquo;ll be solving Hawk Eye. Download the trace file to follow along.\nSome Questions # How many packets does the capture have? At what time was the first packet captured? What is the duration of the capture? What is the most active computer at the link level? Manufacturer of the NIC of the most active system at the link level? What domain is the victim asking about in packet 204? What is the IP of the domain in the previous question? What OS does the victim computer run? What is the name of the malicious file downloaded by the accountant? What\u0026rsquo;s the name of the malware according to malware bytes? If we open the file in Wireshark, this is how it looks! Question 1 answer is the total number of packets shown at the lowermost bar(Packets:4003).\nFor Question 2 and 3 we have to view the trace file properties by going to Statistics \u0026gt; Capture File Properties This infomation about the capture file(metadata) can be displayed using a linux tool called Capinfos. Run sudo apt install capinfos to install it. To answer question 4 we need to find the top talker in Statistics \u0026gt; Endpoints then select the Ethernet tab to view the mac addresses(link level). 00:08:02:1c:47:ae is the most active one. Remember last time we said that the first 3 bytes of any MAC address identifies the Manufacturer. Using this online tool Mac Address Lookup we find the answer for question 5 is Hewlett Packard.\nTo find out the answer for question 6, let\u0026rsquo;s view packet 204. It\u0026rsquo;s proforma-invoices.com! See how easy it easy to identify domain names with name resolution? When a user types a domain name(netflix.com) on the web, it\u0026rsquo;s the work of DNS(Domain Name System) to map that to it\u0026rsquo;s corresponding IP. This process is usually in terms of DNS queries and response. To identify the IP address of proforma-invoices.com, we need to lok at the DNS response which is packet 206.\nWhen you access a resource over the web you basically send a GET request to the web server to retrieve that file. If the accountant downloaded a malicious file we should filter for get requests using http.request.method == GET\nWe can see the name of the Malicious file that was downloaded in packet 210. If we right click that packet and follow HTTP stream, the User-agent tells us what Version of OS the victim computer runs(Windows NT 6.1).\nTo get the name of the Malware we need to download the file and uploaad it to Virus Total, a website to analyze suspicious files. To download it, select packet 210,expand the HyperText Transer Protocol in the Packet details pane then follow the link \u0026ldquo;Response in Frame: 3155\u0026rdquo;. This will take you to packet 3155. Expand the HyperText Protocol for this packet too, then right click File data \u0026gt; Export Packet bytes. Save it with any name. If we run the file command on the saved file we can see it\u0026rsquo;s a windows executable file.\nUpload the file to Virus Total and Violla!\nWell, that was Wireshark! \u0026#x1f632;. We\u0026rsquo;ve just scatched the surface of what this tool can do. This tool has the ability to display the network flow analysis in graphs and also color-code interesting packets. To lean more about Wireshark and it\u0026rsquo;s advanced features, there\u0026rsquo;s no better person than Chris Greer in his youtube channel. Wireshark provides a user-friendly way to interact with packets, but sometimes we as SOC Analysts may be dealing with lots of trace files that requre automation and sripting. We need a commandline tool with similar functionalities as wireshark but one that will offer us the power to handle large-scale network captures and combine other commandline tools for our analysis. That\u0026rsquo;s where Tshark comes in. Next time we will explore Tshark and take our network analysis to the commandline realm.\nTake great care! See ya! \u0026#x1f603;\n","date":"18 July 2023","externalUrl":null,"permalink":"/soc/intro_to_wireshark/","section":"Socs","summary":"","title":"Introduction to Wireshark","type":"soc"},{"content":" What is Network Security? # Network security is the field of cybersecurity focused on protecting computer networks from cyber threats[IBM]. The primary goal of network security is to create a secure environment where legitimate users can access network resources while preventing unauthorized users from gaining access or causing harm. Achieving Network Security involves the implementation of various tools and technologies to ensure confidentiality, integrity and availability of data transmitted over the network.\nNetwork Security Protections # Access control - this is the process of managing and regulating access to systems and resources. Access control ensures that only authorized users can access the appropriate resources and helps protect sensitive data.\nMethods of access control Authentication - authentication is all about verifying identity of users. It\u0026rsquo;s about users prooving that they are who they say they are. There are 3 categories of factors used to verify users.\na. Something you know - could be a pin, password or security questions and when the user gets correct is granted access.\nb. Something you have - involves possession of a physical device or object that uniquely identifies the user; a smart card or maybe a security thumb drive that must be plugged in.\nc. Something you are - this is about unique biometric characteristics of each individual(fingerprint, facial recognition, voice recognition\u0026hellip;)\nCombining 2 or all these factors enhances security significantly. Authorization - After a user is authenticated, based on their authentication identity(Admin or Normal user) you need to determine the level of access privilege they should have. This ensures every user access resources they are permitted to.\nActive Directory is a great service to enable network admins manage permissions and control access to network resources. Firewalls - firewalls could be software/hardware based. They are normally placed at the perimeter bordering the organization internal network and the public internet. Firewalls primary purpose is to monitor and examines incoming and outgoing traffic based on a set of predefined rules then make desicions on whether to permit or deny the packets. Firewall Types Packet Filters Firewalls - These are more traditional. They examine individual data packets based on information such as source and destination IP addresses, port numbers, and protocols. They also lack logging capabilities making them impractical. Firewall logs provide SOC analysts with critical insights such as unauthorised access attempts and other signs of malicious activity. Application Level Firewalls - also known as proxys, these have additional ability to inspect actual content of the packets. Next Generation firewalls - these are employ more advanced technologies such as deep packet inspections and Intrusion prevention systems. Intrusions Detection and Prevention Systems - An Itrusion Detestion Systems(IDS) monitors network traffic and based on matched rules for suspicious behaviour it alerts security personnel. While IDS only detects Intrusions Prevention System(IPS) has the ability to take actions. It goes beyond alerting and responds to possible breaches by blocking the malicious traffic from reaching intended target. IPS is effective for DOS(Denial of Service) attacks. It can detect patterns such as unusually high volume of traffic from specific sources and employ rate limiting of traffic.\nVirtual Private Network - this is a technology that allows users to establish a secure and encrypted connection between their devices and a private network over the internet. When a remote employee is accessing company\u0026rsquo;s resources, they use a VPN client software in their desktops and establish a secure connection to the company\u0026rsquo;s VPN server. This server acts as the gateway for remote employees to connect to the internal network. Once connected, all data transmitted over the public internet between the remote employee\u0026rsquo;s device and the VPN server is encrypted, and it appear as if the user\u0026rsquo;s device is part of the company\u0026rsquo;s internal network. Learn More types of VPN\nNetworking Tools and Commands # ifconfig - this tool shows the network interface configuration of a device. (ipconfig is an alternative for windows).\nping - used to test reachability of a host(device) in a network. When you ping a device you send ICMP Echo request and if the host is online(UP) it\u0026rsquo;ll send back an ICMP Echo reply.\nnslookup (Name Server Lookup)- querys the Domain Name System (DNS) to obtain information about domain names, IP addresses, and various DNS records.\nwhois - used to obtain information about domain name registrations and their associated details. As SOC analysts we can use this took to inspect a suspicious domain. Maybe it\u0026rsquo;s creation date, who owns it(if not private)\u0026hellip;\nnetsat (Network Statistics) - it\u0026rsquo;s utility to display network related info like active network connections. It can help SOC analysts identify active connections with their hosts.\nnmap (Network Mapper) - this is a powerful network scanning and Host discovery tool. It\u0026rsquo;s used by Ethical hackers and malicious actors to discover open ports and services running on a system, their versions and what thype of OS the device runs on. Ethical hackers use to identify security flaws such as outdated version of applications that are vulnerable to attacks. As SOC analysts, we can use this tool to monitor changes in our network and detect newly opened ports.\nPlease Check this Nmap Guide for details on how to use the scan options.\nWe\u0026rsquo;ve discussed network security and some of the technologies available to safeguard our networks and protect ourselves from malicious actors. Moreover, we\u0026rsquo;ve reviewed some useful utilities and tools that help us discover our enviroments. In future series i\u0026rsquo;ll demonstrate how to configure pfsense firewall and also take you through a practical exploration of Snort, an open-source intrusion detection and prevention system.\nBut next time, we\u0026rsquo;ll learn how to use Wireshark, the world\u0026rsquo;s most populalr network protocol analyzer. Wireshark will let us capture network packets, filter specific ones and analyze them.\nUntil then, stay curious! See ya! \u0026#x1f603;\n","date":"17 July 2023","externalUrl":null,"permalink":"/soc/network_security/","section":"Socs","summary":"","title":"Intro to Network Security","type":"soc"},{"content":" Today, let\u0026rsquo;s take a moment to refresh our understanding of the network. As SOC Aanlysts, we established that our role revolves around monitoring and analyzing network traffic. Well, a better understanding of networking concepts - I believe - will allow us to effectively interpret the flow of data in our networks and better detect potential security threats.\nWhat is a Network? # A network is a collection of interconnected devices such as computers, servers, switches and printers that are linked together to facilitate communication and exchange data. Networks can be of different sizes; small networks like your home network with just your TV, mobile phones, fridge and music system or they can as big as the Internet that connects the whole world.\nData Communication # There are 3 ways data can be transmitted from one device to another over the network.\nUnicast - most common one. One-to-One coomunication. Single sender. Single receiver. Like when you DM someone, just you two talking. Multicast - One-to-Many communication. Sending data to multiple receipients at a time. Like when you chat in a group. Broadcast - One-to-All. Sending data to everyone in the network regardless of whether they requested for data. Like posting on status. Addressing # IP Address # Every device that is connected to any network requires a unique identifier in the network. The Internet Protocol address is the identifier assigned to devices when connected to a network. Just like we use our home addresses in delivery services, the IP address serves the purpose of identifying where data is coming from and it\u0026rsquo;s destination to ensure it reaches the intended recipient.\nThere are 2 versions of IP adress: IP version 4(IPv4) and IP version 6(IPv6).\nIPv4 addresses are represented as 4 sets of decimal numbers separated by a period, e.g 192.168.2.1 Each set is reffered to as an octet. Each octet is made up of 8 bits which makes 255 the highest number each octet can take and a total of 32 bits. IPv6 addresses are represented as 8 sets of 4 hexadecimal digits separated by colons e.g 2001:0db8:85a3:0000:0000:8a2e:0370:7334 Each set is made up of 16 bits. Just like you thought, we can drop the leading zeros for simplicity. 2001:db8:85a3::8a2e:370:7334 IP addresses are mainly used for communication across different networks. Subnetting # Subnetting is a technique in computer networks used to divide a single larger IP network into multiple smaller, subnetworks, also known as subnets. This is done to efficiently utilize IP address space, improve network performance, and enhance security by creating smaller broadcast domains.\nA subnet mask is a 32-bit value used in IP (Internet Protocol) networking to determine the network portion and the host portion of an IP address.The subnet mask consists of a series of ones (1s) followed by a series of zeros (0s). The ones indicate the network portion of the IP address, and the zeros indicate the host portion.\nHistorically, IP addresses were divided into classes (Class A, B, C, D, and E) based on their first octedt as shown. eg. 17.34.67.1 would belong to class A because 17 is in the range 1-127, 165.200.48.3 would belong to class B and so on\u0026hellip;this was wasteful of IP address alocation. For example Class A subnet would have 8 bits for network and the rest for hosts as 11111111.00000000.00000000.00000000(255.0.0.0). An IP in class A can accomadate upto 2^hosts_bits, thats 2^24=16777216. No rganization can exhaust such millions of devices. Because of these Classless Inter Domain Routing(CIDR) was introduced.\nCIDR brought efficiency in managing IP address space. In CIDR notation, IP addresses are represented with a combination of the IP address and a slash (\u0026quot;/\u0026quot;) followed by a number, which indicates the length of the network bits eg. 192.168.20.1/8 indicates there are 8 bits for network a the rest for host giving this IP a subnet mask of 11111111.00000000.00000000.00000000(255.0.0.0). This brought flexibility allowing network admins to create subnets of different sizes based on their needs. Same IP could be subnetted with slash 22(/22). Here we get 22 bits for network and 10 for hosts. 1111111.11111111.11111100.00000000(255.255.252.0)\nLearn more subnetting from Professor-Messer\nSubnetting Cheat Sheet\nMAC Address # Also called Physical address, the Medium Access Control Address is used for communications in a local network. This address is burned into the Network Interface Card(NIC) by the manufacturer. It\u0026rsquo;s unique to every NIC and is represented by 6-byte(48bits) hexadecimal value e.g 00-B0-D0-63-C2-26. The first 3 bytes of the mac address identifies the manufacturer/vendor.\nTo see this addresses in your computer, use ip a for linux, ipcofig for windows and ifconfig for mac.\nPorts, Protocols and Services # A protocol is a set of rules that govern communications in computer networks. A port is a logical construct in networks that uniquley identifies services running on a device. There are total of 65536 ports numbered 0-65535. The first 1024 ports(0-1023) are reserved for commonly used services. The rest are available for dynamic use.\nCommon protocols # File Transer Protocol(FTP) - running on port 21 this protocol is responsible for file transferes across devices in the network. Secure Shell Service(SSH) 22 - provides secure remote access to devices over an encrypted connection. Telnet(23) is also for remote connections but it\u0026rsquo;s not secure. Simple Mail Transfer Protocol(SMTP) 25 - used for sending emails. Domain Name Service(DNS) 53 - responsible for translating domain names(yourfavdomain.com) into numerical IP addresses(172.34.5.9). Imagine if you had to remember all the IP address of your favourite sites inorder to access them\u0026hellip;Gosh! HyperText Transfer Protocol(HTTP) 80 - used fpr accessing resources over the internet.(http://example.com/sweetest.jpg) Secure HTTP(HTTPS) 443 - provides additional encryption on the web for secure commmunications. Dynamic Host Configuration Protol - used to dynamically assign IP addresses in a network. Adress Resolution Protocol - used to map MAC addresses associated with a given IP address. Internet Control Message Protocol(ICMP) - this protocol is maily used for error reporting and diagnostics purposes. Anytime two devices are connected through the internet, ICMP can be used to create errors that can go from the receiving device to the sending device if some of the data did not arrive as expected(source -fortinet). Note that ICMP messages are encapsulated within IP packets. ICMP doesn\u0026rsquo;t use ports. So as a SOC analyst, if you observe ICMP traffic on a specific port in your network, it likely indicates ICMP tunneling - a technique used by attackers to carry other types of network traffic within ICMP packets. Research more about your favourite protocol. \u0026#x1f603;\nNetwork models # There are 2 models in computer networks that are used to describe the function of a networking system and clarify the data transmission routine done in a network connection cycle.(Cybertalents).\nThe OSI model - consisting of 7 layers, this is a conceptual framework developed by International Organization for Standardization (ISO) to help better understand how various protocols interact to facilitate communication. Physical Layer being the lowest layer up to Application Layer. The infographic above created by @sysxlpore shows the different functions of each layer. These Layers may also be refered to Layer 1, Layer 1\u0026hellip; upto Layer 7 starting from the physical layer.\nThe TCP/IP model is a more practical and widely used networking model that is closely aligned with the actual protocols and technologies used on the internet. It is named after its two foundational protocols: TCP (Transmission Control Protocol) and IP (Internet Protocol). It consists of 4 Layers; Network access, Internet, Transport and Application.\nInternet Protocol # The Internet Protocol is the protocol that enables Internetworking at the Internet layer of the TCP/IP model. It uses Logical addressing(Ip address) to forward packets(data at the network layer - see encapsulation below) from source to destination. See IPV4 for the description of the header fields above. IPv4 is a connectionless protocol, in that it does not guarantee delivery, nor does it assure proper sequencing or avoidance of duplicate delivery. These aspects, including data integrity, are addressed by an upper layer transport protocol, such as the Transmission Control Protocol (TCP)(Wiki)\nTCP # The TCP protocol is a main protocol in the TCP/IP protocol suite Wiki which operates at the Transport layer. It provides reliable and connection oriented(connection between client and server is established before data can be sent) communication between devices. It uses sequece numbers to ensure data is delivered in order and without errors.\nThe TCP 3 way Handshake # Before any data transmission can occur, TCP establishes a connection between the client and the server using what\u0026rsquo;s called the TCP 3 way handshake.\nStep 1 SYN(Synchronize): # The client initiating the connection first sends a TCP segment to the server with the SYN(Synchronize) flag set. This segment contains a randomly generated sequence number (SEQ) that the server will use to identify the data it receives.\nStep 2 SYN-ACK (Synchronize-Acknowledge): # Upon receiving the segment, the server acknowleges the request by sending a TCP segment back with both SYN and ACK flags set. The server includes it\u0026rsquo;s own random sequence number but it uses the clients sequence_number+1 as it\u0026rsquo;s acknowledgement to indicate that it has received the client\u0026rsquo;s initial sequence number.\nStep 3 ACK(Acknowledgement): # Finally the client responds with another TCP segment that has ACK flag set and an acknowledgement number of server_sequence_number + 1. Now, both devices have established a reliable connection and are ready for data transfer.\nFor a deep dive on how TCP works, check out Chris Greer\nTCP vs UDP # User Datagram Protol(UDP) and TCP are protocols both used in the Transport layer.\nTCP is connection oriented as we saw it established a connection first before data transfer with the 3 way handshake. UDP is coonnectionless therefore does not guarantee reliability. Unlike UDP, TCP impelements flow control to ensure data being sent doesn\u0026rsquo;t overwhelm the rceiver. UDP is faster and is preferred for real-time communication and applications where low latency is more important than reliability like Video streaming. Encapsulation # This is the process of concatenating layer specific headers/tailers as data units are passed down the OSI layer. Each layer adds its own header to the data, creating a layered structure known as a protocol data unit (PDU).(Wiki) Encapsulation allows for the transmission of data across a network by providing the necessary information at each layer. When data at the application layer is passed down to the transport layer, the transport layer adds either a TCP or UDP header which contains the source and destination port numbers, sequence numbers to ensure order\u0026hellip;and more. This Unit in whole becomes a segment. The segment is the handed over to the network layer where the Ip header is added with infomation about the sorce and destination Ip address, Time To Live(lifespan)\u0026hellip;this becomes a packet. The packet again gets to the Data Link Layer where a new header and a tailer are added with the source and destination MAC addresses.This frame now gets to the Physical layer where it is converted into bits for transmission.\nI know \u0026#x1f626;, \u0026ldquo;That was boring! We already know these!\u0026rdquo;. Well, the key take here is how this understanding of computer networks can help us as SOC analysts. Knowing that MAC addresses are to be unique might help us notice attacks like ARP-Spoofing whenever we encounter duplicate MAC addresses from different IPs. The knowledge that ICMP doesn\u0026rsquo;t run on any port offers us the confidence of saying \u0026ldquo;Someone is doing something they shouldn\u0026rsquo;t!\u0026rdquo; next time we see it runing on port 1234 in our network. IS Someone exfiltrating our data????\nNext time, we\u0026rsquo;ll discuss network security and its tools. We\u0026rsquo;ll explore firewalls, intrusion detection and prevention systems, VPNs, and other security measures that fortify your network against malicious activities.\nOnward to secure horizons! Take care! See ya! \u0026#x1f603;\n","date":"15 July 2023","externalUrl":null,"permalink":"/soc/network_refresher/","section":"Socs","summary":"","title":"Networking Refresher","type":"soc"},{"content":"Every mission has an Operation Center. A centralized command center to oversee various activities required to successfully accomplish the mission. A central point of analysis and strategizing. Space explorations have command centers where engineers and scientists, astrounants and mathematicians team up to make desicions and ensure mission success. Militaries have operation centers where all bright minds gather to plan, co-ordinate and execute military operations. Well, to achieve the mission of cyber security of protecting digital assets that we introduced last time we too need an operation center were our team continuously monitor our infrastructures, applications and servers for any suspicious activity. That\u0026rsquo;s where SOC comes in!\nWhat is SOC? # Security Operation Center(SOC) is a cyber security unit consisting of people, processes and technology with a sole purpose of monitoring, detecting and responding to cyber threats. It\u0026rsquo;s the center of an organization cyber security efforts to protect it\u0026rsquo;s assets.\nWhy should we care about SOC? # Hackers are evolving, and cyber attacks now happen everyday with most going un-noticed. SOC offers continuously real-time monitoring of the organization\u0026rsquo;s network traffic for anomalies, system logs and system events for unusual behaviours. With correlation of all these data aggregated from different sources, this unit come\u0026rsquo;s in the first line of cyber defense by investigating incidents, analyzing their imapcts and taking appropriate actions.\n\u0026ldquo;Time is your greatest adversary.\u0026rdquo; That\u0026rsquo;s what Maverick said in Top Gun right? Well, in the event of a security incident, time is of essence. SOC work closely with Threat Hunters to offer timely incident response by proactively hunting for potential threats within the organization that may have gone un-noticed. SOC also leverages Threat intelligence to gain valuable insights about Indicators of compromise and to stay ahead of the attackers tactics, techniques and procedures.\nAnd Lastly, it\u0026rsquo;s the duty of the SOC to assist and make ensure that all systems and applications are compliant with the industry specific regulations for data protections.\nSOC Enviroment # People # This is the team of individuals with enough knowledge, skills and experience to triage alerts, make decisions and handle incidents.\nRoles\nSOC Analyst - this role is at the front-line and is responsible for the continous monitoring of security events and analyze alerts to discover the root cause of the alert. This role can be divided into Tier 1,2 and 3 depending on the level of complexity of the problem. SOC Lead - this position is to lead the team in SOC activities SOC Manager - this role is responsible in managing the whole team, offer guidance and organize the operations. SOC managers are also resplonsible for reporting incidents to the CISO(Chief Information Security Officer) of the organization. Threat Intelligence analyst - they are responsible for collecting and analyzing infomation about emerging threats and their attack techniques. Threat Hunter - Threat hunters proactively seacrh for any signs or indicators that may infer malicious activity within the organization\u0026rsquo;s network. They aim to discover Advanced Persistent Threats(APT) that may have evaded the security measures. Process # This is a well-defined methodology to ensure proper incident handling.\nTechnology # Technology refers to the tools and infrastructure in place both software and hardware to support people and process in automating detection of activities. A good SOC team should have an excellent toolkit of security tools and technology such as SIEM(Security Incident and Event Management) e.g Splunk, UBA(User behaviour Analytics) and SOAR(Security Orchestration Automation and Response).\nTo sum it up, SOC is paramount in todays\u0026rsquo;s cyber security landscape. With it\u0026rsquo;s real time monitoring and incident response capabilities, it plays a pivotal role in today\u0026rsquo;s cyber defense. Next time we\u0026rsquo;ll delve into the world of network security. The ability to understand networks in their normal behaviour is crucial for a SOC analyst to uncovering unusual network traffic and other irregularities that might save the organization from hitting major new\u0026rsquo;s headlines like \u0026ldquo;Cyber Attack Reveals Lack of Security Measures: Organization\u0026rsquo;s Incompetence Exposed\u0026rdquo;. We\u0026rsquo;ll discuss network fundamentals and tools like Wireshark used to monitor and analyze network traffic.\nTake great care! \u0026#x1f60a; See ya! \u0026#x1f603;\n","date":"14 July 2023","externalUrl":null,"permalink":"/soc/introduction_to_soc/","section":"Socs","summary":"","title":"Introduction to SOC","type":"soc"},{"content":"","date":"12 July 2023","externalUrl":null,"permalink":"/tags/incident-response/","section":"Tags","summary":"","title":"Incident Response","type":"tags"},{"content":" At its core, cybersecurity involves protecting computer systems, networks, data, and information from unauthorized access, theft, damage, or disruption. It encompases wide range of measures, processes, strategies, technologies and practices that are set to ensure the confidentiality(only for authorised individuals), integrity(prevent unauthorised modifications) and availability(ensures accessibility all times) of digital assets. Terminologies # Vulnerability \u0026ndash; This is a weakness or a flow in a system that can be exploited by malicious actors. A vulnerability can be due to logic flaws, misconfigurations or even outdated softwares. Exploitation - Taking advantage of a vulnerability to gain access to a computer system. Zero day vulnerability - this is a software vulnerability that is unknown to the software developer. It is called zero day because it is exploited before any patches or fixes are available. CVE(Common Vulneranility Exposures) - this is a database of publicly disclosed information security issues, also CVE standard name for a unique ID which can be used to track publicly known software vulnerabilities and exposures. ### Cyber Attacks A cyber attack refers to a malicious attempt to gain unauthorised access to Computer Systems, Infrastructure and Networks. Depending on the goals and capabilities of the attackers, cyber attacks can be of different forms. Some common cyber attacks include: Phishing - This is a type of Social Engineering attack where the attacker poses a legitimate source to trick victims into revealing their sensitive data like passwords and credit card details or to deploy malicious code in their devices. Phising can be of many types including email phishing, vishing(through telephone), smishing(via text/sms) etc.. Denial of Service(DOS)/Distributed Denial of Service(DDOS) - these attacks are meant to overwhelm targeted systems with traffic rendering them unavailable to other users. Malware attacks - type of attacks that deploys malicious code such as viruses, worms and ransomware to encrypt, steal or disrupt systems operations. Man in the Middle attacks - here the attacker intercepts commmunication between two parties therefore being able to eavesdropp or steal infomation. Insider threats - these attacks are as a result of individuals with legitimate authorised access to company\u0026rsquo;s assets like employees who intentionally compromise systems and networks. ### The Cyber Kill Chain Developed by Lockheed Martin, The Cyber Kill Chain is framework widely used in cyber security to describe the stages that threat actors must go through to conduct a successful cyber attack. This model consist of 7 stages starting right from the initial reconnaissance phase down to the attacker\u0026rsquo;s final objectives. It helps organizations and security proffessionals understand the different phases of an attack. Recon(Reconnaissance) - also known as information gathering it is the first stage where the attacker gathers infomation about the target system/organization. Depending on whether it\u0026rsquo;s passive or active recon, this may include hunting for employees emails on the internet or probing for open ports and services on systems to identify potential vulnerabities.\nWeaponization - once the attacker has gathered required information, they obtain tools(weaponizer) or create specific exploits for the target vulnerabilities in the system.\nDelivery - this is where the attacker lauches the attack. Armed with the malicious payload the attacker may choose to deliver it through phishing email, links or through a malicious USB drive.\nExploitation - In order to gaina access to a system, the attacker must exploit an existing vulnerability in the system. At this stage, the attacker takes advantage of that weakness. It could be weak passwords or outdated softwares.\nInstallation - this is where the attacker establishes foothhold by installing backdoors in order to create persistent access to the victim machine. With this, the attacker maintains control over the compromised system.\nCommand and control(C2) - Here, the attacker opens communication channels with the victim machine allowing full remote control and send commands\u0026hellip;Full manipulation of the victim.\nActions on objectives - This is the final stage where the attacker achieves what he came in to do; steal data, encrypt, destroy systems, moving through the enviroment\u0026hellip;etc\nDefense in depth # Defense in depth is a cyber security strategy that involves implementing multiple layers of security control to protect organization\u0026rsquo;s assets. The goal is to increase overal security of an organization assets. Let\u0026rsquo;s start inside with our data.\nData Security - this layer focuses on securing organization\u0026rsquo;s data at rest and in transist through encryptions to prevent unauthorised access, hashing to infer integrity and DLP(Data Loss Prevention) solutions to monitor and prevent the use of sensitive data.\nApplication security - AppSec deals strategies for securing our software applications to protect against application-level attacks such as SQL-injections and Cross-site scripting attacks. We conduct vulnerability testing to identify and fix vulnerbilities. Also perfoming secure code reviews.\nHost/Endpoint security - to protect out host systems from attacks we configure host based firewalls and deploy endpoint security products like firewalls which help detect and shut down malicious programs.\nNetwork Security - to safegurd our network from threats we may use VLANs segmentations to divide our network broadcast domains and aloso use tools like Intrusion detecction systems and Intrusion prevention systems.\nPerimeter Security - perimeter security deals with security at the boundary of our network. Firewalls helps filter inbound and outbound traffic for anomallies. VPNs also are deployes to enble secure communications between remote employees or business partners and branch offices.\nPhysical security - this is an essential layer to protect physical assets from damage. Employing security gurds, instaling CCTVs and setting up gates and fenses to deter unauthorised entry.\nPolicies and User Awareness - Lastly, the most important is training and educating users and employees about cyber security best practices.\n\u0026ldquo;CYBER SECURITY IS NO LONGER A CHOICE BUT AN IMPERATIVE IN OUR INTERCONNECTED WORLD!\u0026rdquo;\nThat's all for today! Next time we'll introduce what SOC is, it's benefits and why we need it! See ya!:relaxed:","date":"12 July 2023","externalUrl":null,"permalink":"/soc/intoduction_to_cybersecurity/","section":"Socs","summary":"","title":"Introduction to Cyber Security","type":"soc"},{"content":"","date":"12 July 2023","externalUrl":null,"permalink":"/tags/soc/","section":"Tags","summary":"","title":"Soc","type":"tags"},{"content":"","date":"12 July 2023","externalUrl":null,"permalink":"/tags/threathunting/","section":"Tags","summary":"","title":"Threathunting","type":"tags"},{"content":"","date":"2 January 2022","externalUrl":null,"permalink":"/tags/osint/","section":"Tags","summary":"","title":"OSINT","type":"tags"},{"content":"","date":"2 January 2022","externalUrl":null,"permalink":"/tags/registry/","section":"Tags","summary":"","title":"Registry","type":"tags"},{"content":"","date":"2 January 2022","externalUrl":null,"permalink":"/tags/steg/","section":"Tags","summary":"","title":"Steg","type":"tags"},{"content":"","date":"2 January 2022","externalUrl":null,"permalink":"/tags/windows/","section":"Tags","summary":"","title":"Windows","type":"tags"},{"content":"","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":" c1ph3rbnuk/asset-management-project TypeScript 0 0 c1ph3rbnuk/Threat-Intelligence-Automator-TIA- A Python-based security analysis tool that extracts and analyzes PCAP network traffic, detects threats, and correlates logs with at least three Threat Intelligence Feeds. Python 0 0 c1ph3rbnuk/Allogs This repo contains my project trying to implement a SIEM system. JavaScript 0 0 ","externalUrl":null,"permalink":"/projects/","section":"Projects","summary":"","title":"Projects","type":"projects"}]